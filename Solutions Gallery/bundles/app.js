define("ViewGallery/Flx",function(require,exports,module){var _=require("Underscore"),Class=require("tau/core/class"),Event=require("tau/core/event"),Mixin={defaultChangeListener:function(){this.isMounted()&&(this.changeListener||this.forceUpdate).apply(this)},componentDidMount:function(){(this.props.store||this.state.store).onChange(this.defaultChangeListener)},componentWillUnmount:function(){(this.props.store||this.state.store).offChange(this.defaultChangeListener)},componentWillReceiveProps:function(nextProps){nextProps.store&&(this.props.store.offChange(this.defaultChangeListener),nextProps.store.onChange(this.defaultChangeListener))}},createStore=function(proto){var EVENT_NAME="change",Store=Class.extend(_.extend({onChange:function(listener){this.addEventListener(EVENT_NAME,listener)},offChange:function(listener){this.removeListener(EVENT_NAME,listener)},fireChange:function(){this.fire(EVENT_NAME)}},proto));return Event.implementOn(Store.prototype),Store};return module.exports={Mixin:Mixin,createStore:createStore},module.exports}),define("ViewGallery/ScrollToMixin",function(require,exports,module){var $=require("jQuery"),ScrollTo={scrollTo:function(el,offset){var $scrolled;if($scrolled=this.getScrollToScrolledEl?this.getScrollToScrolledEl():$(this.getDOMNode()).parents(".vg-right:first"),el){var rect=el.getBoundingClientRect(),scrollVal=rect.top+(offset||0);$scrolled.animate({scrollTop:"+="+scrollVal})}else $scrolled[0].scrollTop=0}};return module.exports=ScrollTo,module.exports}),define("ViewGallery/SortableMixin",function(require,exports,module){var Sortable={handleDragStart:function(e){e.stopPropagation(),e.dataTransfer.effectAllowed="move";try{e.dataTransfer.setData("text/html",null)}catch(ex){e.dataTransfer.setData("text","")}this.props.sortStarted(this.props.index)},handleDragEnd:function(e){e.stopPropagation(),this.props.sortCompleted(this.props.draggingIndex)},handleDragOver:function(e){e.preventDefault(),e.stopPropagation();var over=e.currentTarget;this.move(over)},move:function(over){var to=Number(over.dataset.index),from=this.props.draggingIndex;from!==to&&this.props.sort(from,to)},isDragging:function(){return this.props.draggingIndex===this.props.index}};return module.exports=Sortable,module.exports}),define("ViewGallery/StickyHeaderMixin",function(require,exports,module){var $=require("jQuery"),resize=function(component){if(component.refs.header&&component.refs.inner){var parentInnerWidth,right=0,innerWidth=component.refs.inner.getDOMNode().getBoundingClientRect().width;if(component.getStickyHeaderParent){var parent=component.getStickyHeaderParent();parent&&(parentInnerWidth=parent.getBoundingClientRect().width)}parentInnerWidth||(parentInnerWidth=component.refs.inner.getDOMNode().parentNode.getBoundingClientRect().width),parentInnerWidth>innerWidth&&(right=parentInnerWidth-innerWidth),$(component.refs.header.getDOMNode()).css({width:innerWidth,right:right}),$(component.refs.inner.getDOMNode()).css({marginTop:component.refs.header.getDOMNode().getBoundingClientRect().height})}},StickyHeader={componentDidUpdate:function(){resize(this)},componentDidMount:function(){resize(this),setTimeout(resize.bind(null,this),500),setTimeout(resize.bind(null,this),1e3),setTimeout(resize.bind(null,this),2e3)}};return module.exports=StickyHeader,module.exports}),define("ViewGallery/appStore",function(require,exports,module){var EventEmitter=require("tau/core/event"),Flx=require("ViewGallery/Flx"),SolutionStore=require("ViewGallery/solutionsStore"),track=require("ViewGallery/track"),boardCreator=require("ViewGallery/boardCreator"),parseApi=require("ViewGallery/parseApi"),externalData=require("ViewGallery/externalData"),dispatcher=require("ViewGallery/dispatcher"),Store=Flx.createStore({init:function(config,settings){parseApi.appId=settings.parseAppId,parseApi.restKey=settings.parseRestKey,this.solutionsStore=new SolutionStore(config),this.isActive=config.activeByDefault,this.isActive&&this.solutionsStore.read(),this.progress=!1,this.deactivateListener=this.deactivate.bind(this),dispatcher.addEventListener("app:deactivate",this.deactivateListener),this.progressUpdateListener=this.updateProgress.bind(this),dispatcher.addEventListener("progress:update",this.progressUpdateListener)},activateFromMenu:function(){track({name:"activateFromMenu"}),this.hideExternalMenu(),this.activate()},activate:function(){this.progress=!1,this.isActive=!0,this.solutionsStore.isLoading=!0,this.solutionsStore.items=[],this.solutionsStore.read(),this.fireChange()},deactivate:function(){boardCreator.resetProcesses(),this.isActive=!1,this.hideExternalMenu(),dispatcher.removeListener("app:deactivate",this.deactivateListener),dispatcher.removeListener("progress:update",this.progressUpdateListener),this.fireChange()},addView:function(){this.isActive=!0,this.solutionsStore.isLoading=!0,this.solutionsStore.items=[],this.fireChange();var configurator=externalData.configurator;configurator.service("boardSettings").get({fields:["ownerIds"],callback:function(){var boardData=configurator.service("boardSettings").settings;this.solutionsStore.read().then(function(){this.solutionsStore.startAddView(boardData)}.bind(this))}.bind(this)})},updateProgress:function(e,val){this.progress=val,this.fireChange()},getPermissions:function(){return this.solutionsStore.logIn().then(function(){return this.solutionsStore.permissions}.bind(this))},hideExternalMenu:function(){var configurator=externalData.configurator;if(configurator.getViewsMenuActionsIntegrationService){var service=configurator.getViewsMenuActionsIntegrationService();service.toggleNewItemMenu&&service.toggleNewItemMenu(!1)}}});return EventEmitter.implementOn(Store.prototype),module.exports=Store,module.exports}),define("ViewGallery/boardApi",function(require,exports,module){var $=require("jQuery"),_=require("Underscore"),store=require("ViewGallery/restApi"),externalData=require("ViewGallery/externalData");return module.exports={allAcid:null,getAllAcid:function(){return this.allAcid?$.when(this.allAcid):this.getAcid("*","*").then(function(acid){return this.allAcid=acid,this.allAcid}.bind(this),function(){return $.when(null)})},getAcid:function(projectIds,teamIds){return store.loadOne("context","",{projectIds:projectIds,teamIds:teamIds}).then(function(res){return res.Acid})},getCurrentContext:function(){return externalData.configurator.getAppStateStore().get({fields:["acid"]}).then(function(res){var acid=res.acid;return store.loadOne("context","",{acid:acid})}).then(function(res){var teams=res.SelectedTeams;return res.AppContext.TeamContext.No&&(teams=[{Id:null}].concat(teams)),{projects:{items:res.SelectedProjects},teams:{items:teams}}})},createBoard:function(config){var appConfigurator=externalData.configurator;return appConfigurator.getViewsMenuService().boardsApi.createViewMenuItem(config).then(function(res){return res.data})},createGroup:function(config){var appConfigurator=externalData.configurator;return appConfigurator.getViewsMenuService().groupsApi.createViewMenuItem(config).then(function(res){return res.data})},getViewFolders:function(){var appConfigurator=externalData.configurator,processGroups=function(items){return items.map(function(v){return{title:v.itemData.name,boardKeys:_.filter(v.children,function(v){return["dashboard","board","customreport"].indexOf(v.itemType)>=0}).map(function(v){return v.itemData.key})}})};return $.ajax({url:appConfigurator.getApplicationPath()+"/api/views/v1",contentType:"application/json; charset=utf-8"}).then(function(res){var items=_.filter(res.items[1].children,function(v){return"group"===v.itemType&&v.itemData.name&&v.children&&v.children.length});return processGroups(items)})},getGroupedViews:function(){var appConfigurator=externalData.configurator,processGroups=function(items){return items.map(function(v){return{title:v.itemData.name||"Ungrouped",boards:_.filter(v.children,function(v){return["dashboard","board","customreport"].indexOf(v.itemType)>=0}).map(function(v){return{title:v.itemData.name,key:v.itemData.key}})}})};return $.ajax({url:appConfigurator.getApplicationPath()+"/api/views/v1",contentType:"application/json; charset=utf-8"}).then(function(res){var items=_.filter(res.items[1].children,function(v){return"group"===v.itemType&&v.children&&v.children.length});return processGroups(items)})},getBoardByKey:function(key){var appConfigurator=externalData.configurator;return $.ajax({url:appConfigurator.getApplicationPath()+"/api/views/v1/board/"+key,contentType:"application/json; charset=utf-8"}).then(function(res){return res})},processBoardData:function(boardData){var configuration=boardData,result={};if("customreport"===boardData.itemType)result=_.pick(configuration,"name","description","itemType","reportSettings"),result.reportSettings=_.omit(result.reportSettings,"tick"),result.reportSettings.dataSource=_.omit(result.reportSettings.dataSource,"global","user");else if("dashboard"===boardData.itemType)result=_.pick(configuration,"name","itemType","layout");else if("board"===boardData.itemType){if(result=_.pick(configuration,"name","itemType","viewMode","cells","x","y","zoomLevel","cardSettings","prioritization","timelineSettings"),configuration.timelineGlobalDateRange){var now=new Date,dates=configuration.timelineGlobalDateRange.split(" — "),startDate=new Date(dates[0]),endDate=new Date(dates[1]);if(startDate&&endDate){var start=Math.ceil((startDate-now)/864e5),end=Math.ceil((endDate-now)/864e5);result.timelineRelativeDays={start:start,end:end}}}result.zoomLevel[result.viewMode]||(result.zoomLevel[result.viewMode]=_.first(_.compact(_.values(result.zoomLevel))))}return result},createConfigFromBoard:function(key){return this.getBoardByKey(key).then(this.processBoardData)}},module.exports}),define("ViewGallery/boardCreator",function(require,exports,module){var _=require("Underscore"),$=require("jQuery"),track=require("ViewGallery/track"),boardApi=require("ViewGallery/boardApi"),store=require("ViewGallery/restApi"),configurator=require("tau/configurator"),prereqImport=require("ViewGallery/prerequisitesImport"),getCfIdentificator=prereqImport.getCfIdentificator,processesCache=[],resetProcesses=function(){processesCache=[]},getProcesses=function(){var list=processesCache;return list.length||(list=store.load("Processes",{include:store.wrapInclude(["Id","Name","Projects-Count",{CustomFields:["Id","Name","Value","EntityFieldName","FieldType","EnabledForFilter","Required",{EntityType:["Id","Name"]},"Config"]}]),take:999}).then(function(res){return processesCache=res})),list},createGlobalDateRange=function(config){if(!config.timelineRelativeDays||null===config.timelineRelativeDays.start||null===config.timelineRelativeDays.end)return null;var months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dates=[];if(config.timelineRelativeDays.start||0===config.timelineRelativeDays.start){var startDate=new Date(Number(new Date)+24*config.timelineRelativeDays.start*3600*1e3);dates.push(startDate.getDate()+"-"+months[startDate.getMonth()]+"-"+startDate.getFullYear())}if(config.timelineRelativeDays.end||0===config.timelineRelativeDays.end){var endDate=new Date(Number(new Date)+24*config.timelineRelativeDays.end*3600*1e3);dates.push(endDate.getDate()+"-"+months[endDate.getMonth()]+"-"+endDate.getFullYear())}return dates.join(" — ")},goToBoard=function(id){var href=$(document.body).find("[data-sortable-key="+id+"]").children("a").prop("href");href&&(window.location.href=href)},getSolutionFullImportData=function(solution){var views=solution.views,dataToImport=_.deepClone(solution.prerequisitesData||{});return dataToImport.process||(dataToImport.customFields=views.reduce(function(res,v){return v.prerequisitesData?res.concat(v.prerequisitesData.customFields):res},[]),dataToImport.customFields=_.uniq(dataToImport.customFields,getCfIdentificator),dataToImport.forceProcesses=_.any(solution.views,function(v){return v.prerequisitesForceProcesses})),dataToImport.process||dataToImport.customFields.length?dataToImport:null},createFromSolution=function(item,opts){var solution=item,acids=[],importData=function(){return prereqImport.importSolution(item,getSolutionFullImportData(item),opts)},createGroup=function(item){track({name:"createGroup",solution:_.omit(solution,"userData","views")});var config={name:item.title,isExpanded:!0,menuIsVisible:!0,menuNumericPriority:Number(new Date)};return boardApi.createGroup(config)},createBoard=function(item,groupId,priority){track({name:"createViewWithGroup",view:_.omit(item,"userData"),solution:_.omit(solution,"userData","views")});var config=_.deepClone(item.config),zoom=config.zoomLevel;return"object"!=typeof zoom&&(config.zoomLevel={},config.zoomLevel[config.viewMode]=zoom),config.name=item.title,config.menuGroupKey=groupId,config.menuNumericPriority=priority,config.menuIsVisible=!0,config.timelineGlobalDateRange=createGlobalDateRange(config),config.acid=acids[priority],boardApi.createBoard(config)},createBoards=function(group){var gone=!1;return $.when.apply(null,item.views.map(function(view,k){return acids[k]?$.when(createBoard(view,group.key,k)).then(function(board){gone||(gone=!0,goToBoard(board.key))}):null}))};return $.when(importData(item)).then(function(res){return opts.onBeforeCreate&&opts.onBeforeCreate(),acids=res,resetProcesses(),createGroup(item)}).then(function(group){return createBoards(group)})},getViewFullImportData=function(view,solution){var dataToImport=_.deepClone(view.prerequisitesData||{}),solutionDataToImport=_.deepClone(solution.prerequisitesData||{});return dataToImport=_.extend(dataToImport,solutionDataToImport),dataToImport.customFields=dataToImport.process?dataToImport.process.customFields:dataToImport.customFields,dataToImport.customFields=dataToImport.customFields||[],dataToImport.forceProcesses=view.prerequisitesForceProcesses,dataToImport.process||dataToImport.customFields.length?dataToImport:null},createFromView=function(view,solution,opts){track({name:"createView",view:_.omit(view,"userData"),solution:_.omit(solution,"userData","views")});var importData=function(){var dataToImport=getViewFullImportData(view,solution);return prereqImport.importView(dataToImport,opts)},config=_.deepClone(view.config),zoom=config.zoomLevel;return"object"!=typeof zoom&&(config.zoomLevel={},config.zoomLevel[config.viewMode]=zoom),config.name=view.title,config.menuIsVisible=!0,config.menuNumericPriority=Number(new Date),config.timelineGlobalDateRange=createGlobalDateRange(config),$.when(importData()).then(function(acid){return opts.onBeforeCreate&&opts.onBeforeCreate(),resetProcesses(),config.acid=acid,boardApi.createBoard(config)}).then(function(res){var id=res.key;return goToBoard(id),res})},getImportRestrictions=function(solution,views){var processCustomFields=function(dataToImport){return dataToImport.customFields=views.reduce(function(res,v){return v.prerequisitesData?res.concat(v.prerequisitesData.customFields):res},dataToImport.customFields),dataToImport.customFields=_.uniq(dataToImport.customFields,getCfIdentificator),dataToImport},user=configurator.getLoggedUser();if(user.isAdministrator)return $.when(!1);var dataToImport=_.deepClone(solution.prerequisitesData||{});if(dataToImport.process?dataToImport.customFields=[]:(dataToImport.customFields=dataToImport.customFields||[],dataToImport=processCustomFields(dataToImport)),!dataToImport.process&&!dataToImport.customFields.length)return $.when(!1);var checkFields=function(process1,process2){return _.all(process1.CustomFields,function(cf){return _.any(process2.CustomFields,function(cf2){return getCfIdentificator(cf)===getCfIdentificator(cf2)})})};return $.when(getProcesses()).then(function(processes){if(dataToImport.process){var processData=dataToImport.process,process=_.findWhere(processes,{Name:processData.Name});if(!process)return"no-process";if(!process["Projects-Count"])return"no-project"}else if(dataToImport.customFields)return processes=_.filter(processes,function(process){return process["Projects-Count"]}),processes.length?(processes=_.filter(processes,function(process){return checkFields({CustomFields:dataToImport.customFields},process)}),processes.length?!1:"no-customfields"):"no-any-process"})},getSolutionImportRestrictions=function(solution){if(solution.prerequisitesData&&solution.prerequisitesData.process)return $.when(getImportRestrictions(solution,[])).then(function(code){return{code:code,disabled:Boolean(code),process:"no-project"===code||"no-process"===code?solution.prerequisitesData.process:null}});var views=_.filter(solution.views,function(v){return v.objectId}),restrictions=views.map(function(v){return getImportRestrictions(solution,[v])});return $.when.apply(null,restrictions).then(function(){var restrs=_.toArray(arguments),restrictedViews=views.reduce(function(res,v,k){return restrs[k]&&(res=res.concat(v)),res},[]),res={code:!1,views:restrictedViews};restrictedViews.length&&(res.code="no-customfields"),restrictedViews.length===views.length&&(res.disabled=!0);var cfs=restrictedViews.reduce(function(res,v){return res.concat(v.prerequisitesData.customFields||[])},[]);return cfs=_.uniq(cfs,getCfIdentificator),res.customFields=cfs,res})},getViewImportRestrictions=function(view,solution){return $.when(getImportRestrictions(solution,[view])).then(function(code){return{code:code,disabled:Boolean(code),process:"no-project"===code||"no-process"===code?solution.prerequisitesData.process:null,customFields:"no-customfields"===code?view.prerequisitesData.customFields:null}})};return module.exports={createFromSolution:createFromSolution,createFromView:createFromView,getSolutionImportRestrictions:getSolutionImportRestrictions,getViewImportRestrictions:getViewImportRestrictions,getSolutionFullImportData:getSolutionFullImportData,getViewFullImportData:getViewFullImportData,resetProcesses:resetProcesses},module.exports}),define("ViewGallery/dispatcher",function(require,exports,module){var Bus=require("tau/core/bus"),dispatcher=new Bus;return module.exports=dispatcher,module.exports}),define("ViewGallery/externalData",function(require,exports,module){return module.exports={configurator:null},module.exports}),define("ViewGallery/fileInputMultipleStore",function(require,exports,module){var EventEmitter=require("tau/core/event"),_=require("Underscore"),Flx=require("ViewGallery/Flx"),Store=Flx.createStore({id:0,init:function(item){var urls=item.screenshotImg?[item.screenshotImg]:[];urls=item.screenshotImgs&&item.screenshotImgs.length?item.screenshotImgs:urls,this.items=urls.map(function(v){return{id:++this.id,userData:{},file:v}}.bind(this)),this.items=this.items.concat({id:null,userData:{}})},read:function(){this.fireChange()},select:function(item){this.items=this.items.map(function(v){return v.userData.isSelected=!1,v}),item.userData.isSelected=!0,this.activeIndex=this.items.indexOf(item),this.fireChange()},remove:function(item){item.id&&(this.items=_.without(this.items,item),this.fireChange())},update:function(item,value){item.file=value.resizeData,item.inputData=value,item.id||(item.id=++this.id,this.items=this.items.concat({id:null,userData:{}})),this.fireChange()},reorder:function(from,to){var items=this.items,item=items[from];items.splice(from,1),items.splice(to,0,item),this.draggingIndex=to,this.items=items,this.fireChange()},startSort:function(index){this.draggingIndex=index,this.fireChange()},startAdd:function(){_.findWhere(this.items,{id:null})||(this.items=this.items.concat({id:null,userData:{}})),this.fireChange()},getValue:function(){return _.filter(this.items,function(v){return v.id}).map(function(v){return v.inputData||v})}});return EventEmitter.implementOn(Store.prototype),module.exports=Store,module.exports}),define("ViewGallery/makeHttpsImg",function(require,exports,module){return module.exports=function(url){return url&&window.location.href.match(/^https:\/\//)?"https://images.weserv.nl/?url="+window.encodeURI(url.replace(/^http:\/\//,"")):url},module.exports}),define("ViewGallery/markdown",function(require,exports,module){var $=require("jQuery"),ShowdownConverter=require("showdown").converter,converter=new ShowdownConverter;return module.exports={toHtml:function(val){var t=converter.makeHtml(val||"");return $("<div />").html(t).html()}},module.exports}),define("ViewGallery/notify",function(require,exports,module){var configurator=require("tau/configurator"),error=function(message){configurator.getBusRegistry().getByName("application board").then(function(bus){bus.fire("error",{message:message})})},success=function(message){configurator.getBusRegistry().getByName("application board").then(function(bus){setTimeout(function(){bus.fire("notification",{message:message})},2e3)})};return module.exports={success:success,error:error},module.exports}),define("ViewGallery/parseApi",function(require,exports,module){var _=require("Underscore"),$=require("jQuery"),uriRgx=/(files|installations|login|push|roles|requestPasswordReset|users)/,api={base:"https://api.parse.com/1/",appId:"",restKey:"",sessionToken:null,request:function(method,resource,data,opts){data=data||{},data._method=method;var req=_.extend({contentType:"application/json",dataType:"json",url:this.base+(uriRgx.test(resource)?resource:"classes/"+resource),type:"POST",headers:{"X-Parse-Application-Id":this.appId,"X-Parse-REST-API-Key":this.restKey}},opts||{});return this.sessionToken&&(req.headers["X-Parse-Session-Token"]=this.sessionToken),"object"!=typeof data?$.ajax(req):(data=JSON.stringify(data),req.data=data,$.ajax(req))},get:function(resource,data){return this.request("GET",resource,data).then(function(res){return res.results})},getOne:function(resource,id,data){return this.request("GET",resource+"/"+id,data)},update:function(resource,id,data){return this.request("PUT",resource+"/"+id,data)},create:function(resource,data){return this.request("POST",resource,data)},save:function(resource,data){return data.objectId?this.update(resource,data.objectId,data):this.create(resource,data)},destroy:function(resource,data){return this.request("DELETE",resource+"/"+(data.objectId?data.objectId:data))},login:function(username,password){return this.request("GET","login",{username:username,password:password})},uploadFile:function(name,base64,contentType){var data,dataUriRegexp=/^data:([a-zA-Z]*\/[a-zA-Z+.-]*);(charset=[a-zA-Z0-9\-\/\s]*,)?base64,(\S+)/,matches=dataUriRegexp.exec(base64);if(matches&&matches.length>0){data=4===matches.length?matches[3]:matches[2],contentType||(contentType=matches[1]);var def=$.Deferred();return this.request("POST","files/"+name,{_ContentType:contentType,base64:data},{xhr:function(){var xhr=new window.XMLHttpRequest;return xhr.upload.addEventListener("progress",def.notify),xhr}}).then(def.resolve,def.reject),def}throw new Error("Bad base64 file")}};return module.exports=api,module.exports}),define("ViewGallery/prerequisitesExport",function(require,exports,module){var $=require("jQuery"),_=require("Underscore"),store=require("ViewGallery/restApi"),configurator=require("tau/configurator"),hasTerms=Boolean(configurator.getStore().typeMetaInfo("process").refs.terms),getProcess=function(id){return store.loadOne("Processes",id,{include:store.wrapInclude(["Name","Description",{Projects:["Id","Name"]},{Practices:["Id","Name"]},{CustomFields:["Id","Name","Value","EntityFieldName","FieldType","EnabledForFilter","Required",{EntityType:["Id","Name"]},"Config"]}])})},getEntityStates=function(process){return store.load("EntityStates",{include:store.wrapInclude(["Id","Name","IsInitial","IsFinal","IsPlanned","IsCommentRequired",{EntityType:["Id"]}]),where:"Process.Id eq "+process.Id,orderBy:"NumericPriority"})},getTerms=function(process){return hasTerms?store.load("Terms",{include:store.wrapInclude(["WordKey","Value"]),where:"Process.Id eq "+process.Id,take:999}):process.Projects.length?store.loadOne("context","",{projectIds:process.Projects[0].Id}).then(function(res){return res.Processes[0].Terms}):[]},exportProcess=function(id){var result={};return $.when(getProcess(id)).then(function(process){var copyProcess=_.omit(process,"Id","Projects");return copyProcess.CustomFields=copyProcess.CustomFields.map(function(v){return _.omit(v,"Id","ConfigString")}),result.process=copyProcess,$.when(getEntityStates(process),getTerms(process))}).then(function(entityStates,terms){return result.entityStates=entityStates.map(function(v){return _.omit(v,"Id")}),result.terms=terms,result})},exportCustomFields=function(customFields){var result={};return result.customFields=customFields.map(function(v){return _.omit(v,"Id","ConfigString")}),result};return module.exports={doExport:exportProcess,doExportView:exportCustomFields},module.exports}),define("ViewGallery/prerequisitesImport",function(require,exports,module){var _=require("Underscore"),$=require("jQuery"),configurator=require("tau/configurator"),hasWorkflows=Boolean(configurator.getStore().typeMetaInfo("process").refs.workflows),boardApi=require("ViewGallery/boardApi"),store=require("ViewGallery/restApi"),createTerms=function(process,termsData){var defaultTerms={Release:["Release","Releases"],Iteration:["Iteration","Iterations"],SquadIteration:["Team Iteration","Team Iterations"],Epic:["Epic","Epics"],Feature:["Feature","Features"],UserStory:["User Story","User Stories"],Bug:["Bug","Bugs"],Build:["Build","Builds"],Impediment:["Impediment","Impediments"]},terms=_.object(termsData.map(function(v){return[v.Name||v.WordKey,v.Value]})),resTerms={};_.forEach(defaultTerms,function(defTerms,entityType){_.forEach(defTerms,function(v,k){terms[v]&&(resTerms[entityType]||(resTerms[entityType]={}),resTerms[entityType][k?"plural":"single"]=terms[v])})});var sendTerms=_.map(resTerms,function(v,k){return v.entityKind=k,v});return store.insert("../../terms/",{processId:process.Id,terms:sendTerms})},getAcidByProjects=function(projects){return boardApi.getAcid(_.pluck(projects,"Id").join(","),"*")},getAcidByContextData=function(contextData){var args=["projects","teams"].map(function(v){if(contextData[v].all)return"*";var items=_.pluck(contextData[v].items,"Id");return items=items.map(function(v){return null===v?"null":v}),items.join(",")});return boardApi.getAcid.apply(boardApi,args)},getAllAcid=function(){return boardApi.getAllAcid()},getAllProcesses=function(){return store.load("Processes",{include:store.wrapInclude(["Name",{Projects:["Id","Name","IsActive"]},{CustomFields:["Id","Name","Value","Config","FieldType",{EntityType:["Id","Name"]}]}])}).then(function(res){return res.map(function(v){return v.Projects=_.where(v.Projects,{IsActive:!0}),v})})},findProcess=function(processData){return store.load("Processes",{include:store.wrapInclude(["Id","Name",{CustomFields:["Id","Name","Value","EntityFieldName","FieldType","EnabledForFilter","Required",{EntityType:["Id","Name"]},"Config"]}])}).then(function(items){return _.find(items,function(v){return v.Name.toLowerCase()===processData.Name.toLowerCase()})})},findProcessById=function(id){return store.loadOne("Processes",id,{include:store.wrapInclude(["Id","Name",{Projects:["Id","Name","IsActive"]},{CustomFields:["Id","Name","Value","EntityFieldName","FieldType","EnabledForFilter","Required",{EntityType:["Id","Name"]},"Config"]}])}).then(function(res){return res.Projects=_.where(res.Projects,{IsActive:!0}),res})},getProcessesByProjects=function(projects){var findByProjects=function(process){return _.any(projects,function(pr){return _.find(process.Projects,function(pr2){return pr2.Id===pr.Id})})};return $.when(getAllProcesses()).then(function(processes){return _.filter(processes,findByProjects)})},escapeRegExp=function(str){return str.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},findProjectByName=function(name){var reg=new RegExp("^"+escapeRegExp(name)+"( \\((\\d+)\\))?$","i");return store.load("Projects",{take:999,orderBy:"Name"}).then(function(items){var exact=_.find(items,function(v){return v.Name.toLowerCase()===name.toLowerCase()});if(!exact)return null;items=_.map(items,function(v){var match=v.Name.match(reg);return match?{item:v,count:Number(match[2]||0)}:null}),items=_.compact(items);var max=items.reduce(function(res,v){return v.count>=res.count?v:res},{count:0});return max})},findProjects=function(processData){return store.load("Projects",{include:store.wrapInclude(["Name",{Process:["Id","Name"]}]),where:['(Process.Name eq "'+processData.Name+'")','(isActive eq "True")'].join(" and ")})},createProject=function(process,name){return store.insert("Projects",{Name:name||process.Name,Process:{Id:process.Id}})},createProcess=function(processData){processData.CustomFields=processData.CustomFields.map(function(v){return"DefaultValue"in v.Config||(v.Config.DefaultValue=null),v});var dataToInsert={Name:processData.Name,Description:processData.Description,Practices:processData.Practices,CustomFields:processData.CustomFields};if(hasWorkflows){var workflows=_.groupBy(processData.EntityStates,function(state){return state.EntityType.Id});workflows=_.values(workflows).map(function(states){return{Name:"Main Workflow",EntityType:states[0].EntityType,EntityStates:states.map(function(v,k){var es=_.omit(v,"EntityType");return es.NumericPriority=k,es})}}),dataToInsert.Workflows=workflows}return $.when(store.insert("Processes",dataToInsert)).then(function(process){return $.when(process,createTerms(process,processData.Terms||[]))})},createAll=function(processData,newProjectName,onProgress){return $.when(!0).then(function(){return createProcess(processData)}).then(function(process){return onProgress(50),$.when(process,createProject(process,newProjectName))}).fail(function(){return $.when(null)})},createConfirm=function(next,args){if(next){var def=new $.Deferred;return next.apply(null,args.concat(function(code){code===!1?def.reject():arguments.length?def.resolve.apply(def,_.toArray(arguments)):def.resolve.apply(def,args)})),def}return $.when.apply(null,args)},getOrCreateProcessWithProjects=function(processData,opts){var onProgress=opts.onProgress||function(){},newProjectName=processData.Name,confirmExistingProcessAndExistingProjects=function(process,projects){return createConfirm(opts.onConfirmExistingProcessAndExistingProjects,[process,projects])},confirmNewProcessAndNewProject=function(process,project){return createConfirm(opts.onConfirmNewProcessAndNewProject,[process,project])},confirmExistingProcessAndNewProject=function(process,project){return createConfirm(opts.onConfirmExistingProcessAndNewProject,[process,project])};return $.when(findProcess(processData),findProjectByName(newProjectName)).then(function(process,project){return project&&(newProjectName=newProjectName+" ("+(project.count+1)+")"),$.when(process,process?findProjects(process):[])}).then(function(process,projects){var newProject={Name:newProjectName};return process?projects.length?confirmExistingProcessAndExistingProjects(process,projects):confirmExistingProcessAndNewProject(process,newProject):confirmNewProcessAndNewProject(processData,newProject)}).then(function(process,projects){return onProgress(30),process&&process.Id?projects.length?process:createProject(process,newProjectName).then(function(){return onProgress(50),process}):createAll(process,newProjectName,onProgress)}).then(function(process){return findProcessById(process.Id)})},getCfIdentificator=function(cf){return[cf.Name,cf.EntityType.Name,cf.FieldType].join("|")},getConnectedTeams=function(projects){if(!projects.length)return[];var ids=_.pluck(projects,"Id");return store.load("Projects",{include:store.wrapInclude([{TeamProjects:[{Team:["Id"]}]}]),where:["Id in ("+ids+")"].join(" and ")}).then(function(res){return res.reduce(function(res,v){return res.concat(_.pluck(v.TeamProjects,"Team"))},[])})},findProcessesWithCustomFields=function(customFields){var isAdministrator=configurator.getLoggedUser().isAdministrator,countFields=function(process1,process2){return _.reduce(process1.CustomFields,function(res,cf){return _.any(process2.CustomFields,function(cf2){return getCfIdentificator(cf)===getCfIdentificator(cf2)})?res+1:res},0)};return $.when(getAllProcesses()).then(function(processes){if(processes=_.filter(processes,function(pr){return pr.Projects.length
}),processes=processes.map(function(pr){return pr.cfCount=countFields({CustomFields:customFields},pr),pr}),processes=_.sortBy(processes,function(v){return-1*v.cfCount}),processes.length&&processes[0].cfCount>0){var maxProcess=processes[0];if(!isAdministrator&&maxProcess.cfCount<customFields.length)return[];if(maxProcess.cfCount<customFields.length)return[maxProcess];var max=maxProcess.cfCount;return _.where(processes,{cfCount:max})}return[]})},findProjectsWithCustomFields=function(customFields){return $.when(findProcessesWithCustomFields(customFields)).then(function(processes){return _.flatten(_.pluck(processes,"Projects"))})},findExistingCustomFieldsInProcesses=function(customFields){return $.when(findProcessesWithCustomFields(customFields)).then(function(processes){if(processes.length){var process=processes[0],findByIdentificator=function(cf,cf2){return getCfIdentificator(cf)===getCfIdentificator(cf2)},cfs=customFields.map(function(cf){return _.find(process.CustomFields,findByIdentificator.bind(null,cf))||cf});return cfs}return customFields})},updateProcessesWithCustomFields=function(processes,customFieldsData,onProgress){var progress=0,part=100/processes.length;customFieldsData=customFieldsData.map(function(v){return _.omit(v,"Id")});var update=function(process){return process.CustomFields=process.CustomFields.concat(customFieldsData),process.CustomFields=_.uniq(process.CustomFields,getCfIdentificator),process.CustomFields=process.CustomFields.map(function(v){return"DefaultValue"in v.Config||(v.Config.DefaultValue=null),v}),store.update("Processes",process.Id,process).then(function(res){return progress+=part,onProgress(progress),res},function(){return progress+=part,onProgress(progress),process})},defs=processes.map(update);return $.when.apply(null,defs)},importData=function(dataToImport,opts){if(!(dataToImport&&(dataToImport.process||dataToImport.customFields&&dataToImport.customFields.length)))return boardApi.getAllAcid();var acid,confirmImportError=function(){return createConfirm(opts.onImportError,[])},processes=[],onProgress=opts.onProgress||function(){};if(dataToImport.process){var processData=dataToImport.process;processData.EntityStates=dataToImport.entityStates,processData.Terms=dataToImport.terms,processes=$.when(!0).then(function(){return getOrCreateProcessWithProjects(processData,opts)}).then(function(process){return onProgress(90),$.when(getAcidByProjects(process.Projects),process)}).then(function(result,process){return acid=result,[process]})}else if(dataToImport.customFields.length){var isAdministrator=configurator.getLoggedUser().isAdministrator;processes=$.when.apply(null,[findProjectsWithCustomFields(dataToImport.customFields),findExistingCustomFieldsInProcesses(dataToImport.customFields)]).then(function(projects,customFields){return $.when(projects,getConnectedTeams(projects),customFields)}).then(function(projects,teams,customFields){var confirmCF=createConfirm(opts.onConfirmCustomFields,[projects,teams,customFields]);return $.when(confirmCF)}).then(function(contextData,customFields){if(onProgress(10),contextData&&0!==contextData.length){var projects=contextData.projects.items;return $.when(getAcidByContextData(contextData),getProcessesByProjects(projects),customFields)}return $.when(getAllAcid(contextData),getAllProcesses(),dataToImport.customFields)}).then(function(acid,processes,customFields){return $.when(acid,isAdministrator?updateProcessesWithCustomFields(processes,customFields,onProgress):[])}).then(function(res){return acid=res})}else onProgress(50);var execute=$.when(processes).then(function(){return acid});return $.when(execute).then(function(res){return res},confirmImportError)},importSolution=function(solution,dataToImport,opts){if(dataToImport)return $.when(importData(dataToImport,opts)).then(function(acid){return solution.views.map(function(v){return solution.userData.importRestrictions&&"no-customfields"===solution.userData.importRestrictions.code&&solution.userData.importRestrictions.views&&solution.userData.importRestrictions.views.indexOf(v)>=0?null:acid})});var confirmContext=createConfirm(opts.onConfirmContext,[]);return $.when(confirmContext).then(function(contextData){return getAcidByContextData(contextData)}).then(function(acid){return solution.views.map(function(){return acid})})},importView=function(dataToImport,opts){if(dataToImport)return importData(dataToImport,opts);var confirmContext=createConfirm(opts.onConfirmContext,[]);return $.when(confirmContext).then(function(contextData){return getAcidByContextData(contextData)})};return module.exports={importView:importView,importSolution:importSolution,getCfIdentificator:getCfIdentificator},module.exports}),define("ViewGallery/restApi",function(require,exports,module){var $=require("jQuery"),_=require("Underscore"),configurator=require("tau/configurator"),loadSimple=function(url,params){return $.ajax({type:"get",url:url,contentType:"application/json; charset=utf-8",dataType:"json",data:params})},processResult=function(result){return _.isArray(result)?result.map(function(v){return processResult(v)}):_.isObject(result)?result.Items&&_.isArray(result.Items)?processResult(result.Items):_.object(_.map(result,function(v,k){var key=k;return[key,processResult(v)]})):result},load=function(resource,params){var loadPages=function loadPages(url,params){return loadSimple(url,params).then(function(res){var items=res.Items;return res.Next?loadPages(res.Next).then(function(nextItems){return items.concat(nextItems)}):items})};return loadPages(configurator.getApplicationPath()+"/api/v1/"+resource,params).then(function(res){return processResult(res)})},loadOne=function(resource,id,params){return loadSimple(configurator.getApplicationPath()+"/api/v1/"+resource+"/"+id,params).then(function(res){return processResult(res)})},postSimple=function(url,params){return $.ajax({type:"post",url:url,contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify(params)})},removeSimple=function(url,params){return $.ajax({type:"post",url:url,contentType:"application/json; charset=utf-8",dataType:"json",headers:{"X-HTTP-Method-Override":"DELETE"},data:JSON.stringify(params)})},insert=function(resource,params){return postSimple(configurator.getApplicationPath()+"/api/v1/"+resource,params).then(function(res){return processResult(res)})},update=function(resource,id,params){return postSimple(configurator.getApplicationPath()+"/api/v1/"+resource+"/"+id,params).then(function(res){return processResult(res)})},remove=function(resource,id){return removeSimple(configurator.getApplicationPath()+"/api/v1/"+resource+"/"+id).then(function(res){return processResult(res)})},stringify=function(obj){var res="";return obj&&(Array.isArray(obj)?res=obj.map(stringify).join(","):"object"==typeof obj?res=Object.keys(obj).map(function(key){return key+"["+stringify(obj[key])+"]"}).join(","):"function"!=typeof obj&&(res=String(obj))),res},wrapInclude=function(obj){return"["+stringify(obj)+"]"};return module.exports={load:load,loadOne:loadOne,insert:insert,update:update,remove:remove,wrapInclude:wrapInclude},module.exports}),define("ViewGallery/solutionsGroupStore",function(require,exports,module){var EventEmitter=require("tau/core/event"),_=require("Underscore"),Flx=require("ViewGallery/Flx"),parseApi=require("ViewGallery/parseApi"),Store=Flx.createStore({init:function(solutionStore,group){if(this.solutionStore=solutionStore,this.items=group.items,this.title=group.title,this.type=group.type,this.permissions=_.extend({},solutionStore.permissions),this.permissions.addFolder=this.permissions.add,this.permissions.add=this.permissions.add&&!Boolean(group.host),this.permissions.collapse=this.permissions.edit&&!this.permissions.add,this.isCollapsed=!1,this.permissions.collapse){var r=!1;try{r=JSON.parse(window.localStorage.getItem("vg__group__"+this.title+"__collapsed"))}catch(e){}this.isCollapsed=r}},getListItems:function(){var getItems=function(folderId,items,level){return _.reduce(items,function(res,v){return v&&(folderId&&v.folderId===folderId||!folderId&&!v.folderId)?("folder"===v.type&&(v.userData.level=level,v.items=getItems(v.objectId,items,v.userData.level+1),v.userData.isExpanded=v.userData.isExpanded===!1?!1:v.userData.isExpanded||_.any(v.items,function(vv){return vv.userData.isExpanded||vv.userData.isSelected})),res.concat(v)):res},[])},items=this.items.map(function(v,k){return v.userData.sourceIndex=k,v.userData.level=0,v});return items=this.permissions.edit||"general"===this.type?getItems(null,items,0):_.reject(items,function(v){return"folder"===v.type})},reorder:function(from,to){if(this.isDragging){var item=this.items[from];this.items.splice(from,1),this.items.splice(to,0,item),this.draggingIndex=to,this.solutionStore.items=_.union(_.difference(this.solutionStore.items,this.items),this.items),this.fireChange()}},prioritize:function(index){var item=this.items[index];this.items[index].userData.isDragging=!1,this.isDragging=!1;var priority,minPriority=0,maxPriority=9007199254740992,delta=1e6,prev=index?this.items[index-1]:null,next=this.items[index+1];next&&prev?priority=(next.priority+prev.priority)/2:next?priority=next.priority/1.5:prev&&(priority=prev.priority+delta),priority=Math.round(priority),minPriority>=priority||priority>=maxPriority||prev&&priority===prev.priority||next&&priority===next.priority?(this.items=this.items.map(function(v,k){return v.priority=(delta+1)*(k+1),v}),this.writePriorities()):(item.priority=priority,this.solutionStore.writeOne(item)),this.solutionStore.items=_.union(_.difference(this.solutionStore.items,this.items),this.items),this.fireChange()},startSort:function(index){this.draggingIndex=index,this.items[index].userData.isDragging=!0,this.isDragging=!0,this.solutionStore.items=_.union(_.difference(this.solutionStore.items,this.items),this.items),this.fireChange()},writePriorities:function(){this.items.forEach(function(item){return parseApi.save("Solution",_.pick(item,"objectId","priority"))})},toggleCollapse:function(){this.isCollapsed=!this.isCollapsed,window.localStorage&&window.localStorage.setItem("vg__group__"+this.title+"__collapsed",JSON.stringify(this.isCollapsed)),this.fireChange()}});return EventEmitter.implementOn(Store.prototype),module.exports=Store,module.exports}),define("ViewGallery/solutionsStore",function(require,exports,module){var EventEmitter=require("tau/core/event"),_=require("Underscore"),$=require("jQuery"),parseApi=require("ViewGallery/parseApi"),configurator=require("tau/configurator"),ViewStore=require("ViewGallery/viewsStore"),markdown=require("ViewGallery/markdown"),boardCreator=require("ViewGallery/boardCreator"),boardApi=require("ViewGallery/boardApi"),Flx=require("ViewGallery/Flx"),track=require("ViewGallery/track"),notify=require("ViewGallery/notify"),dispatcher=require("ViewGallery/dispatcher"),prerequisites=require("ViewGallery/prerequisitesExport"),Store=Flx.createStore({init:function(authConfig){this.authConfig=authConfig,this.items=[],this.filterText="",this.permissions={add:!1,edit:!1,remove:!1},this.user=null,this.isLoading=!0},logIn:function(){var setLogged=function(user){return this.user=user,this.permissions={add:!0,edit:!0,remove:!0},$.when(this.user)}.bind(this),setAnonymous=function(){return this.user="anonymous",this.permissions={add:!1,edit:!1,remove:!1},parseApi.currentUser=null,$.when(this.user)}.bind(this);if(this.authConfig&&this.authConfig.login&&this.authConfig.password){var currentUser=parseApi.currentUser;return currentUser?setLogged(currentUser):parseApi.login(this.authConfig.login,this.authConfig.password).then(function(user){return parseApi.sessionToken=user.sessionToken,parseApi.currentUser=user,setLogged(user)},function(err){return this.err=err,setAnonymous()}.bind(this))}return setAnonymous()},read:function(){this.isAdding=!1,this.zeroView=!1,this.draggingIndex=null,this.items=[],this.filterText="";var toArray=function(res){return(_.isArray(res)?res:res.toArray()).map(function(vv){return vv.userData=vv.userData||{},vv.userData.itemTypeTitle="solution",vv.priority=vv.priority||0,vv})},fetchSolutions=function(host){return parseApi.get("Solution",{limit:1e3,order:"priority",where:host?{hostsAccess:{$in:[null,host]}}:void 0})},fetchViews=function(solutionIds){return parseApi.get("View",{limit:1e3,order:"priority",where:{parentId:{$in:solutionIds}}})};return this.logIn().then(function(){var host=configurator.getApplicationPath().replace(/https?:\/\//,""),speedTrack=track.start();return $.when(fetchSolutions(this.permissions.edit?!1:host)).then(function(solutions){solutions=toArray(solutions);var ids=_.pluck(solutions,"objectId");return $.when(solutions,fetchViews(ids))}).then(function(solutions,views){views=toArray(views);var groupedViews=_.groupBy(views,function(v){return v.parentId});if(this.items=solutions.map(function(v){return v.views=groupedViews[v.objectId]||[],v}),this.lastSelectedId){var selected=_.findWhere(this.items,{objectId:this.lastSelectedId});selected&&(selected.userData.isSelected=!0)}if(this.lastSelectedViewId){var view=_.findWhere(views,{objectId:this.lastSelectedViewId});view&&(view.userData.isSelected=!0)}speedTrack.stop({name:"serverRequest",type:"success"}),this.isLoading=!1,this.fireChange()}.bind(this),function(errs){var err=_.find(errs,function(v){return v&&v.message});notify.error("Server is not responding"),speedTrack.stop({name:"serverRequest",type:"error"}),track({name:"serverError",err:err})})}.bind(this))},write:function(){this.items.forEach(function(v){this.writeOne(v)}.bind(this))},writeOne:function(item){return parseApi.save("Solution",_.omit(item,"userData")).then(function(res){res.objectId&&(item.objectId=res.objectId)},function(err){this.err=err,this.read()}.bind(this))},saveFromItems:function(item){var res=this.writeOne(item);return this.isEditing&&(this.isEditing=!1,this.fireChange()),res},select:function(item){var prevSelected=_.find(this.items,function(v){return v.userData.isSelected});this.items=this.items.map(function(v){return v.userData.isSelected=!1,v.userData.isEditingFull=!1,v.userData.showVideo=!1,v}),item.userData.isSelected=!0,this.isAdding?(prevSelected&&(prevSelected.views=_.reject(prevSelected.views,function(v){return!v.objectId})),item.views=item.views||[],item.views.indexOf(this.zeroView)<0&&item.views.push(this.zeroView)):prevSelected&&(prevSelected=this.resetViews(prevSelected)),prevSelected&&!prevSelected.objectId&&(this.items=_.without(this.items,prevSelected)),item.userData.scrollTo="start",Boolean(this.filterText)?item.userData.scrollTo="search":_.any(item.views,function(v){return v.userData&&v.userData.isSelected})?item.userData.scrollTo="edit":_.any(item.views,function(v){return v.userData&&v.userData.isSelected})&&(item.userData.scrollTo="select"),this.fireChange()},selectById:function(id){this.select(_.findWhere(this.items,{objectId:id}))},getSelected:function(){var selected=_.find(this.items,function(v){return v.userData.isSelected});return selected&&(selected.userData.fullPrerequisitesData=boardCreator.getSolutionFullImportData(selected)),selected},startAdd:function(parentFolder){if(!_.any(this.items,function(v){return v.userData.isEditing})){var folderId;parentFolder&&(folderId=parentFolder.objectId,parentFolder.userData.isExpanded=!0),this.items=this.items.map(function(v){return v.userData.isSelected=!1,v.userData.isEditingFull=!1,v.views=_.reject(v.views,function(vv){return!vv.objectId}),v});var newItem={title:"",userData:{isSelected:!0,isEditingFull:!0},folderId:folderId,views:[]};this.zeroView&&(newItem.views=[this.zeroView]),this.items=this.items.concat(newItem),this.fireChange()}},stopAdd:function(solution,isTrigger){this.isAdding=!1,this.zeroView=!1,solution.views=_.reject(solution.views,function(v){return!v.objectId}),isTrigger&&this.fireChange()},startEdit:function(item){this.permissions.edit&&(_.any(this.items,function(v){return v.userData.isEditing})||(item.userData.isEditingFull=!1,item.userData.isEditing=!0,this.fireChange()))},cancelEdit:function(item){item.objectId?(item.userData.isEditing=!1,item.userData.tmpTitle="",this.fireChange()):(this.items=_.without(this.items,item),this.fireChange())},save:function(item,title){title=title.trim(),title.length?(item.title=title,item.userData.isEditing=!1,"folder"!==item.type&&(this.items=this.items.map(function(v){return v.userData.isSelected=!1,v}),item.userData.isSelected=!0),item.objectId||(item.priority=Number(new Date)),this.fireChange(),this.writeOne(item)):item.objectId||(this.items=_.without(this.items,item),this.fireChange())},togglePrereq:function(item){item.userData.showPrereq=!item.userData.showPrereq,item.userData.showPrereqTooltip=!1,item.userData.showPrereq&&(this.scrollTo="prereq"),this.fireChange()},togglePrereqTooltip:function(item,val){item.userData.showPrereqTooltip=item.userData.showPrereq?!1:val,item.userData.showPrereq||(item.userData.importStatus=!1),this.fireChange()},toggleVideo:function(item){item.userData.showVideo=!item.userData.showVideo,this.fireChange()},toggleShowImportRestrictions:function(item,val){item.userData.showImportRestrictions=val,this.fireChange()},startAddView:function(config){if(!this.items.length)return void this.fireChange();this.isAdding=!0,this.items=this.items.map(function(v){return this.resetViews(v,"all")}.bind(this));var selected;this.lastSelectedId&&(selected=_.findWhere(this.items,{objectId:this.lastSelectedId}));var solution=selected||this.items[0];solution.userData.isSelected=!0,solution.views=solution.views||[],this.zeroView={title:config.name,shortDescription:"",userData:{isSelected:!0,isEditing:!0},config:boardApi.processBoardData(_.deepClone(config))},solution.views.push(this.zeroView),this.fireChange()},startRemove:function(item){this.items=this.items.map(function(v){return v.userData.isWaitingConfirmation=!1,v}),item.userData.isWaitingConfirmation=!0,this.fireChange()},cancelRemove:function(item){item.userData.isWaitingConfirmation=!1,this.fireChange()},remove:function(item){var i=this.items.indexOf(item),next=this.items[i-1]||this.items[i+1];this.items=_.without(this.items,item),item.userData.isSelected&&next&&"folder"!==next.type&&(next.userData.isSelected=!0),"folder"===item.type&&(this.items=this.items.map(function(v){return v.folderId===item.objectId&&(v.folderId=null,this.writeOne(v)),v}.bind(this)));var removeViews=item.views.map(function(v){return v.objectId?parseApi.destroy("View",v):!0});$.when.apply(null,removeViews).then(function(){return parseApi.destroy("Solution",item)}).then(function(){},function(err){this.err=err,this.read()}.bind(this)),this.fireChange()},resetViews:function(item,type){return item.views=item.views||[],item.views=_.reject(item.views,function(v){return!v.objectId}),item.views=item.views.map(function(v){return"all"===type?v.userData={}:(v.userData.isEditing=!1,v.userData.isWaitingConfirmation=!1),v}),item},createBoards:function(item){item=this.resetViews(item,"all"),item.userData.importStatus=null,item.userData.importContinuation=null,item.userData.showImportRestrictions=!1,item.userData.isCreating=!1,item.userData.createProgress=0,this.fireChange();var makeContinuation=function(next){return next};boardCreator.createFromSolution(item,{onConfirmCustomFields:function(projects,teams,customFields,next){item.userData.importData={projects:projects,teams:teams,customFields:customFields},item.userData.importStatus="customfields",item.userData.importContinuation=next,this.fireChange()}.bind(this),onConfirmContext:function(next){$.when(boardApi.getCurrentContext()).then(function(context){item.userData.importData={projects:context.projects.items,teams:context.teams.items},item.userData.importStatus="context",item.userData.importContinuation=next,this.fireChange()}.bind(this))}.bind(this),onConfirmNewProcessAndNewProject:function(process,project,next){item.userData.importData={process:{Name:process.Name},project:{Name:project.Name}},item.userData.importStatus="new-process-and-new-project",item.userData.importContinuation=makeContinuation(next),this.fireChange()}.bind(this),onConfirmExistingProcessAndNewProject:function(process,project,next){item.userData.importData={process:process,project:{Name:project.Name}},item.userData.importStatus="existing-process-and-new-project",item.userData.importContinuation=makeContinuation(next),this.fireChange()}.bind(this),onConfirmExistingProcessAndExistingProjects:function(process,projects,next){item.userData.importData={process:process,projects:projects},item.userData.importStatus="existing-process-and-existing-projects",item.userData.importContinuation=makeContinuation(next),this.fireChange()}.bind(this),onImportError:function(next){notify.error("We've had some problems during import, but solution will be created anyway"),next()},onProgress:function(val){item.userData.isCreating=!0,item.userData.createProgress=val,dispatcher.fire("progress:update",val),this.fireChange()}.bind(this),onBeforeCreate:function(){this.deactivateApp()}.bind(this)}).then(function(){notify.success("Solution has been added to your Targetprocess account"),item.userData.importData=null,item.userData.importStatus=null,item.userData.importContinuation=null,this.fireChange()}.bind(this))},confirmImport:function(item,confirmData){confirmData?item.userData.importContinuation(confirmData.context,confirmData.customFields):"customfields"===item.userData.importState?item.userData.importContinuation(null,null):item.userData.importContinuation(),item.userData.importData=null,item.userData.importStatus=null,this.fireChange()},cancelImport:function(item){item.userData.importData=null,item.userData.importStatus=null,item.userData.importContinuation=null,this.fireChange()},deactivateApp:function(){var time=100;setTimeout(function(){dispatcher.fire("app:deactivate")},time)},startEditFull:function(item){this.items=this.items.map(function(v){return v.userData.isEditing=!1,v.userData.isEditingFull=!1,v.userData.isWaitingConfirmation=!1,v.userData.tmpTitle=null,item.userData.isLoading=!1,item.userData.loadProgress=0,v}),item.userData.tmpTitle=item.title,item.userData.isEditingFull=!0,item.userData.isSelected=!0;var hasCfs=_.any(item.views,function(v){return v.prerequisitesData&&v.prerequisitesData.customFields&&v.prerequisitesData.customFields.length});item.userData.viewsHasCfs=hasCfs,item=this.resetViews(item,"all"),this.fireChange()},saveFull:function(item,formData){_.extend(item,formData),item.descriptionHtml=markdown.toHtml(item.description),item.prerequisitesHtml=markdown.toHtml(item.prerequisites);var isNew=!Boolean(item.objectId);isNew&&(item.priority=Number(new Date)),item.hostsAccess=item.hosts.length?item.hosts:[null],item.userData.isLoading=!0,item.userData.loadProgress=0,item.ACL={},item.ACL["*"]={read:!0,write:!0},this.isAdding&&(item.views=item.views||[],item.views.indexOf(this.zeroView)<0&&item.views.push(this.zeroView)),item.prerequisitesProcessId=formData.prerequisitesProcessId;var execute;item.prerequisitesProcessId?(execute=$.Deferred(),prerequisites.doExport(item.prerequisitesProcessId).then(execute.resolve.bind(execute),execute.reject.bind(execute)),execute=execute.then(function(exportData){return item.userData.loadProgress=10,item.prerequisitesData=exportData,this.writeOne(item)}.bind(this),function(){return this.writeOne(item)}.bind(this)).then(function(){this.fireChange()}.bind(this))):(item.prerequisitesData=null,execute=this.writeOne(item).then(function(){this.fireChange()}.bind(this))),isNew&&formData.viewFolder&&(execute=execute.then(function(){return this.importFromFolder(item,formData.viewFolder)}.bind(this))),execute.then(function(){item.userData.isLoading=!1,item.userData.isEditingFull=!1,this.fireChange()}.bind(this)),this.fireChange()},importFromFolder:function(item,folder){var addAndSaveView=function(view){item.views=item.views.concat(view);var store=new ViewStore(item,this);return store.writeOne(view)},views=folder.boardKeys.map(function(key,k){return boardApi.createConfigFromBoard(key).then(function(config){return{title:config.name,userData:{},config:config,priority:k}})}),part=100/(views.length||1),execute=$.Deferred();return $.when.apply(null,views).then(function(){execute.resolve(_.toArray(arguments))}),execute.then(function(processedViews){var saves=processedViews.reduce(function(res,v){return res.then(addAndSaveView.bind(this,v)).then(function(){item.userData.loadProgress+=part,this.fireChange()}.bind(this))}.bind(this),$.when(!0));return saves.then(function(){this.fireChange()}.bind(this))}.bind(this))},cancelEditFull:function(item){item.objectId?item.userData.isEditingFull&&(item.userData.isEditingFull=!1,this.isAdding&&(item.views=item.views||[],item.views.indexOf(this.zeroView)<0&&item.views.push(this.zeroView)),this.fireChange()):(this.items=_.without(this.items,item),this.fireChange())},setTmpTitle:function(item,title){item.userData.tmpTitle=title,this.fireChange()},filter:function(text){this.filterText=text,text&&(clearTimeout(this.filterTimeout),this.filterTimeout=setTimeout(function(){track({name:"applyFilter",text:text})},1e3)),this.fireChange()},getListItems:function(){var filterText=this.filterText.trim().toLowerCase(),items=_.filter(this.items,function(v){return v.objectId});items=_.map(items,function(v){v.userData.isMatchFilter=!1;var isSolutionMatch=!filterText||!v.objectId||v.title.toLowerCase().indexOf(filterText)>=0;if(isSolutionMatch)v.userData.isMatchFilter=!0;else{var isViewMatch=_.any(v.views,function(view){return ViewStore.isMatchFilter(view,filterText)});v.userData.isMatchFilter=isViewMatch}return v});var grouped=_.groupBy(items,function(v){return v.hosts.length?"custom":""}),groups=_.map(grouped,function(v,k){return{host:k,title:k?"Custom Solutions":"Solutions",items:v,type:k||"general"}});groups=_.sortBy(groups,function(v){return v.host}),groups.length||(groups=[{host:"",title:"Solutions",items:[],type:"general"}]);var selected=_.find(this.items,function(v){return v.userData.isSelected});if(!selected){var group=_.find(groups,function(v){return v.items.length>0});group&&(selected=_.find(group.items,function(v){return"folder"!==v.type}),selected.userData.isSelected=!0)}return selected&&selected.objectId&&(this.lastSelectedId=selected.objectId),this.selected=selected,groups},startFeedback:function(){this.feedbackStatus="",this.isFeedback=!0,this.fireChange()},cancelFeedback:function(){this.isFeedback=!1,this.fireChange()},submitFeedback:function(message){if(message){var host=configurator.getApplicationPath(),item={message:message,host:host,username:window.loggedUser.name,user:window.loggedUser};parseApi.save("Feedback",item),this.feedbackStatus="success",this.fireChange()}},moveView:function(view,solutionFrom,solutionToId){solutionFrom.views=_.without(solutionFrom.views,view);var solutionTo=_.findWhere(this.items,{objectId:solutionToId});solutionTo.views.push(view);var viewStore=new ViewStore(solutionTo,this);viewStore.prioritize(solutionTo.views.length-1),this.select(solutionTo)},scrolledTo:function(){this.scrollTo=!1},addFolder:function(parent,group){var parentId;parent&&(parentId=parent.objectId,parent.userData.isExpanded=!0);var item={title:"Folder",type:"folder",hosts:group&&"custom"===group.type?["dummy"]:parent?parent.hosts:[],hostsAccess:group&&"custom"===group.type?[null,"dummy"]:parent?parent.hostsAccess:[null],dataToImport:{},views:[],folderId:parentId,userData:{isEditing:!0}};this.writeOne(item).then(function(){this.items=[item].concat(this.items),this.fireChange()}.bind(this))},toggleCollapseFolder:function(item){item.userData.isExpanded=!item.userData.isExpanded,window.localStorage&&window.localStorage.setItem("vg__folder__"+item.objectId+"__collapsed",JSON.stringify(item.userData.isExpanded)),this.fireChange()}});return EventEmitter.implementOn(Store.prototype),module.exports=Store,module.exports}),define("ViewGallery/terms",function(require,exports,module){var configurator=require("tau/configurator"),types=configurator.getStore().getTypes().getDictionary(),termMap={priority:"Business Value",projectmember:"Project Allocation",entitystate:"State",tag:"Tags",assigneduser:"Person",source:"Request Source",outboundrelations:"Outbound Relations",inboundrelations:"Inbound Relations"},modeMap={board:"Board",list:"One by one",newlist:"List",timeline:"Timeline"},getTermTitle=function(term){var normTerm=term.toLowerCase();return termMap.hasOwnProperty(normTerm)?termMap[normTerm]:types[normTerm]?types[normTerm].terms.name.val:term=term.replace(/^ddl/,"")},getViewModeTitle=function(name){return modeMap[name]||name};return module.exports={getTermTitle:getTermTitle,getViewModeTitle:getViewModeTitle},module.exports}),define("ViewGallery/track",function(require,exports,module){var track=function(data){window.taus&&window.taus.track("ViewGallery",data)};return track.start=function(data){return window.taus?window.taus.start("ViewGallery",data):void 0},module.exports=track,module.exports}),define("ViewGallery/viewsStore",function(require,exports,module){var EventEmitter=require("tau/core/event"),_=require("Underscore"),$=require("jQuery"),parseApi=require("ViewGallery/parseApi"),Flx=require("ViewGallery/Flx"),markdown=require("ViewGallery/markdown"),terms=require("ViewGallery/terms"),notify=require("ViewGallery/notify"),dispatcher=require("ViewGallery/dispatcher"),boardCreator=require("ViewGallery/boardCreator"),prerequisites=require("ViewGallery/prerequisitesExport"),boardApi=require("ViewGallery/boardApi"),stringMatch=function(text,v){return v=(v||"").toLowerCase(),v.indexOf(text)>=0},isMatchFilter=function(item,filterText){var match=stringMatch.bind(null,filterText),matchAny=function(items){return _.any(items,match)},getTermTitles=function(items){return(items||[]).map(function(v){return terms.getTermTitle(v)})},matchTerms=function(terms){return matchAny(getTermTitles(terms))},matchConfigLine=function(line){return line&&line.types&&line.types.length?matchTerms(line.types):!1},res=!filterText||!item.objectId||match(item.title)||matchAny(item.tags);return!res&&item.config?match(terms.getViewModeTitle(item.config.viewMode))||matchConfigLine(item.config.cells)||matchConfigLine(item.config.x)||matchConfigLine(item.config.y):res},Store=Flx.createStore({init:function(solution,store){this.solution=solution,this.solutionStore=store,this.items=[];var data=this.solution.views||[];this.items=data.map(function(v){return v.userData=v.userData||{},v.userData.itemTypeTitle={customreport:"report",dashboard:"dashboard",board:"view"}[v.config&&v.config.itemType||"board"],v.tags=v.tags||[],v}),this.permissions=this.solutionStore.permissions,this.scrollTo=solution.userData.scrollTo},read:function(){var data=this.solution.views||[];this.items=data.map(function(v){return v.userData=v.userData||{},v.userData.itemTypeTitle={customreport:"report",dashboard:"dashboard",board:"view"}[v.config&&v.config.itemType||"board"],v.tags=v.tags||[],v}),this.scrollTo=this.solution.userData.scrollTo,this.fireChange()},writeOne:function(item){var data=_.omit(item,"userData");return data.parentId=item.parentId||this.solution.objectId,parseApi.save("View",data).then(function(res){res.objectId&&(item.objectId=res.objectId)},function(err){this.err=err,this.read()}.bind(this))},selectInner:function(item){var prev=_.find(this.items,function(v){return v.userData.isSelected});prev&&prev!==item&&!prev.objectId&&(this.items=_.without(this.items,prev),this.solution.views=this.items,this.solutionStore.isAdding=!1,this.solutionStore.zeroView=!1),item.userData.isEditing&&item.userData.isSelected||(this.items=this.items.map(function(v){return v.userData.isEditing=!1,item.userData.isWaitingConfirmation=!1,v.userData.isSelected=v===item?!v.userData.isSelected:!1,v}),this.solutionStore.lastSelectedViewId=null,this.solutionStore.cancelEditFull(this.solution))},select:function(item){this.hasViewTransition=!0,this.selectInner(item),this.scrollTo="select",this.fireChange()},hasNext:function(item){return this.items.indexOf(item)<this.items.length-1},hasPrev:function(item){return this.items.indexOf(item)>0},selectNext:function(item){var next=this.items.indexOf(item)+1;
next>=this.items.length&&(next=0);var nextItem=this.items[next];this.hasViewTransition=!1,this.pagingDirection="next",this.scrollTo="top",this.selectInner(nextItem),this.fireChange()},selectPrevious:function(item){var next=this.items.indexOf(item)-1;0>next&&(next=this.items.length-1);var nextItem=this.items[next];this.hasViewTransition=!1,this.pagingDirection="prev",this.scrollTo="top",this.selectInner(nextItem),this.fireChange()},getSelected:function(){var selected=_.find(this.items,function(v){return v.userData.isSelected});return selected&&(selected.userData.fullPrerequisitesData=boardCreator.getViewFullImportData(selected,this.solution)),selected},startEdit:function(item){this.items=this.items.map(function(v){return v.userData.isEditing=!1,v.userData.isSelected=!1,item.userData.isWaitingConfirmation=!1,v}),item.userData.tmpTitle=null,item.userData.isEditing=!0,item.userData.isSelected=!0,this.scrollTo="edit",this.fireChange()},cancelEdit:function(item){item.objectId?(item.userData.isEditing=!1,item.userData.isWaitingConfirmation=!1,this.fireChange()):this.solutionStore.stopAdd(this.solution,!0)},toggleScreenshot:function(item){item.userData.isScreenshotFull=!item.userData.isScreenshotFull,this.fireChange()},togglePrereq:function(item){item.userData.showPrereq=!item.userData.showPrereq,item.userData.showPrereqTooltip=!1,item.userData.showPrereq&&(this.scrollTo="prereq"),this.fireChange()},togglePrereqTooltip:function(item,val){item.userData.showPrereqTooltip=item.userData.showPrereq?!1:val,item.userData.showPrereq||(item.userData.importStatus=!1),this.fireChange()},toggleVariations:function(item){item.userData.showVariations=!item.userData.showVariations,this.fireChange()},toggleConfig:function(item){item.userData.showConfig=!item.userData.showConfig,this.fireChange()},toggleConfigOnView:function(item){item.userData.hideConfigOnView=!item.userData.hideConfigOnView,this.fireChange()},save:function(item,formData){item.userData.isLoading=!0,item.userData.loadProgress=0;var total=0,loaded={},loadFile=function(res){if(!res||!_.isObject(res))return null;total+=res.resizeData.length;var name=res.file.name.replace(/[^\w.]/g,"0");return parseApi.uploadFile(name,res.resizeData).progress(function(e){loaded[name]=e.loaded;var loadedSum=_.values(loaded).reduce(function(res,v){return res+v},0),percent=loadedSum/total*100;item.userData.loadProgress=percent,this.fireChange()}.bind(this)).then(function(res){return res})}.bind(this),loadConfig=function(){return formData.configByKey?boardApi.createConfigFromBoard(formData.configByKey):null},loadFiles=function(data){var loads=data.map(function(v){return _.isObject(v.file)?loadFile(v):v.file});return $.when.apply(null,loads).then(function(){return _.toArray(arguments)})};return $.when.apply(null,[loadFile(formData.previewImg.file),loadFiles(formData.screenshotImg),loadConfig()]).then(function(preview,screenshots,config){item=_.extend(item,_.omit(formData,"previewImg","screenshotImg")),item.descriptionHtml=markdown.toHtml(item.description),item.prerequisitesHtml=markdown.toHtml(item.prerequisites),item.variationsHtml=markdown.toHtml(item.variations),item.tags=(item.tags||"").split(",").map(function(v){return v.trim()}),item.tags=_.unique(_.compact(item.tags)),preview?item.previewImg=preview.url:formData.previewImg.isClear&&(item.previewImg=null),item.screenshotImgs=screenshots.map(function(v){return v.url?v.url:v}),item.screenshotImg=null,config&&(item.config=config,item.userData.itemTypeTitle={customreport:"report",dashboard:"dashboard",board:"view"}[item.config&&item.config.itemType||"board"]),item.userData.isEditing=!1,item.userData.isWaitingConfirmation=!1,item.userData.isLoading=!1,item.userData.loadProgress=0,item.prerequisitesDataCustomFields=formData.prerequisitesDataCustomFields,item.prerequisitesData=prerequisites.doExportView(formData.prerequisitesDataCustomFields),this.writeOne(item).then(function(){if(!item.priority){var index=this.items.indexOf(item);index>=0&&this.prioritize(index)}}.bind(this)),this.solutionStore.stopAdd(this.solution),item.parentId!==this.solution.objectId?this.solutionStore.moveView(item,this.solution,item.parentId):(this.moveToSelected=!0,this.fireChange())}.bind(this))},startRemove:function(item){this.items=this.items.map(function(v){return v.userData.isWaitingConfirmation=!1,v}),item.userData.isWaitingConfirmation=!0,this.fireChange()},cancelRemove:function(item){item.userData.isWaitingConfirmation=!1,this.fireChange()},remove:function(item){this.items=_.without(this.items,item),this.solution.views=this.items,parseApi.destroy("View",item).then(function(){},function(err){this.err=err,this.read()}.bind(this)),this.solutionStore.fireChange()},createBoard:function(item){item.userData.importStatus=null,item.userData.importContinuation=null,item.userData.showImportRestrictions=!1,item.userData.isCreating=!1,item.userData.createProgress=0,this.fireChange();var makeContinuation=function(next){return next};boardCreator.createFromView(item,this.solution,{onConfirmCustomFields:function(projects,teams,customFields,next){item.userData.importData={projects:projects,teams:teams,customFields:customFields},item.userData.importStatus="customfields",item.userData.importContinuation=makeContinuation(next),this.fireChange()}.bind(this),onConfirmContext:function(next){$.when(boardApi.getCurrentContext()).then(function(context){item.userData.importData={projects:context.projects.items,teams:context.teams.items},item.userData.importStatus="context",item.userData.importContinuation=next,this.fireChange()}.bind(this))}.bind(this),onConfirmNewProcessAndNewProject:function(process,project,next){item.userData.importData={process:{Name:process.Name},project:{Name:project.Name}},item.userData.importStatus="new-process-and-new-project",item.userData.importContinuation=makeContinuation(next),this.fireChange()}.bind(this),onConfirmExistingProcessAndNewProject:function(process,project,next){item.userData.importData={process:process,project:{Name:project.Name}},item.userData.importStatus="existing-process-and-new-project",item.userData.importContinuation=makeContinuation(next),this.fireChange()}.bind(this),onConfirmExistingProcessAndExistingProjects:function(process,projects,next){item.userData.importData={process:process,projects:projects},item.userData.importStatus="existing-process-and-existing-projects",item.userData.importContinuation=makeContinuation(next),this.fireChange()}.bind(this),onImportError:function(next){notify.error("We've had some problems during import, but view will be created anyway"),next()},onProgress:function(val){item.userData.isCreating=!0,item.userData.createProgress=val,dispatcher.fire("progress:update",val),this.fireChange()}.bind(this),onBeforeCreate:function(){this.deactivateApp(item)}.bind(this)}).then(function(){notify.success(item.userData.itemTypeTitle.slice(0,1).toUpperCase()+item.userData.itemTypeTitle.slice(1)+" has been added to your Targetprocess account"),item.userData.importData=null,item.userData.importStatus=null,item.userData.importContinuation=null,this.fireChange()}.bind(this))},confirmImport:function(item,confirmData){confirmData?item.userData.importContinuation(confirmData.context,confirmData.customFields):"customfields"===item.userData.importState?item.userData.importContinuation(null,null):item.userData.importContinuation(),item.userData.importData=null,item.userData.importStatus=null,this.fireChange()},cancelImport:function(item){item.userData.importData=null,item.userData.importStatus=null,item.userData.importContinuation=null,this.fireChange()},deactivateApp:function(item){var time=400;item.userData.isSelected&&(item.userData.isSelected=!1,this.solutionStore.fireChange(),setTimeout(function(){dispatcher.fire("app:deactivate")},time))},setTmpTitle:function(item,title){item.userData.tmpTitle=title,this.fireChange()},reorder:function(from,to){if(this.isDragging){var item=this.items[from];this.items.splice(from,1),this.items.splice(to,0,item),this.draggingIndex=to,this.fireChange()}},prioritize:function(index){var item=this.items[index];this.items[index].userData.isDragging=!1,this.isDragging=!1;var priority,minPriority=0,maxPriority=9007199254740992,delta=1e6,prev=index?this.items[index-1]:null,next=this.items[index+1];next&&prev?priority=(next.priority+prev.priority)/2:next?priority=next.priority/1.5:prev&&(priority=prev.priority+delta),priority=Math.round(priority),minPriority>=priority||priority>=maxPriority||prev&&priority===prev.priority||next&&priority===next.priority?(this.items=this.items.map(function(v,k){return v.priority=(delta+1)*(k+1),v}),this.writePriorities()):(item.priority=priority,this.writeOne(item)),this.solution.views=this.items,this.fireChange()},startSort:function(index){var hasZero=_.find(this.items,function(v){return!v.objectId});return hasZero?!1:(this.items=this.items.map(function(v){return v.userData.isEditing=!1,v.userData.isSelected=!1,v.userData.isWaitingConfirmation=!1,v}),this.draggingIndex=index,this.items[index].userData.isDragging=!0,this.isDragging=!0,void this.fireChange())},writePriorities:function(){this.items.forEach(function(item){return parseApi.save("View",_.pick(item,"objectId","priority"))})},getListItems:function(){var filterText=this.solutionStore.filterText.trim().toLowerCase(),items=_.reject(this.items,function(v){return!v.objectId&&!this.solution.objectId}.bind(this));return items=_.map(items,function(v){return v.userData.isMatchFilter=isMatchFilter(v,filterText),v}),"search"===this.scrollTo&&(items=items.map(function(v){return v.userData.isSelected=v.userData.isMatchFilter&&v.userData.isSelected,v})),items},selectTag:function(tag,item){item.userData.isSelected=!1,this.solutionStore.filter(tag)},scrolledTo:function(){this.scrollTo=!1,this.solution.userData.scrollTo=!1},getSolutions:function(){return this.solutionStore.getListItems()},selectSolution:function(id){this.solutionStore.selectById(id)},toggleShowImportRestrictions:function(item,val){item.userData.showImportRestrictions=val,this.fireChange()}});return Store.isMatchFilter=isMatchFilter,EventEmitter.implementOn(Store.prototype),module.exports=Store,module.exports}),define("ViewGallery/App",function(require,exports,module){"use strict";var React=require("react"),ReactCSSTransitionGroup=React.addons.CSSTransitionGroup,SolutionList=require("ViewGallery/SolutionList"),SolutionViewer=require("ViewGallery/SolutionViewer"),Overlay=require("ViewGallery/Overlay"),Flx=require("ViewGallery/Flx"),App=React.createClass({displayName:"App",mixins:[Flx.Mixin],render:function(){var overlay,store=this.props.store;if(store.isActive){var progress,solutionsStore=store.solutionsStore;store.progress!==!1&&(progress=React.createElement("div",{className:"tau-loader"})),overlay=React.createElement(Overlay,{scrollable:!1,onClose:this.handleClose},React.createElement("div",{className:"vg"+(store.progress?" vg-loading":"")},React.createElement(SolutionList,{store:solutionsStore}),React.createElement("div",{className:"vg-right"},React.createElement("div",{className:"vg-wrapper-scroll"},React.createElement(SolutionViewer,{store:solutionsStore})))),progress)}return React.createElement(ReactCSSTransitionGroup,{transitionName:"vg-overlay-animation"},overlay)},handleClose:function(){this.props.store.deactivate()}});return module.exports=App,module.exports}),define("ViewGallery/Button",function(require,exports,module){var React=require("react"),_=require("Underscore"),Button=React.createClass({displayName:"Button",getDefaultProps:function(){return{type:"button",className:"vg-btn",progress:0}},render:function(){var children=this.props.children,className=this.props.className;this.props.loaderActive&&this.props.loaderProgress>0&&this.props.loaderProgress<=100&&(children=[React.createElement("span",{key:"progress",className:"vg-btn__progress",style:{width:this.props.loaderProgress+"%"}}),children],className+=" vg-btn-loader");var props=_.extend(this.props,{className:className,children:children});return React.addons.cloneWithProps(React.createElement("button",null),props)}});return module.exports=Button,module.exports}),define("ViewGallery/Confirmation",function(require,exports,module){var React=require("react"),Confirmation=React.createClass({displayName:"Confirmation",getDefaultProps:function(){return{orientation:"left",okLabel:"Yes, I'm sure",cancelLabel:"No"}},componentDidMount:function(){this.listener=function(e){this.getDOMNode().contains(e.target)||this.handleCancel(e)}.bind(this),document.addEventListener("click",this.listener,!0)},componentWillUnmount:function(){document.removeEventListener("click",this.listener,!0)},render:function(){return React.createElement("div",{className:"tau-bubble tau-warning-bubble i-role-bubble i-state_visible vg-confirmation i-orientation_"+this.props.orientation+" "+(this.props.className||""),"data-orientation":this.props.orientation},React.createElement("div",{className:"tau-bubble__arrow tau-container","data-orientation":this.props.orientation}),React.createElement("div",{className:"tau-bubble__inner tau-container"},React.createElement("div",null,React.createElement("h3",null,this.props.children)),React.createElement("div",{className:"tau-buttons"},React.createElement("button",{type:"button",className:"tau-btn tau-primary i-role-actionok",onClick:this.handleConfirm},this.props.okLabel),React.createElement("button",{type:"button",className:"tau-btn i-role-actioncancel",onClick:this.handleCancel},this.props.cancelLabel))))},handleConfirm:function(e){this.props.onConfirm(e)},handleCancel:function(e){this.props.onCancel(e)}});return module.exports=Confirmation,module.exports}),define("ViewGallery/ContextInput",function(require,exports,module){var ContextInputList,React=require("react"),cx=React.addons.classSet,$=require("jQuery"),_=require("Underscore"),restApi=require("ViewGallery/restApi"),mapRecursive=function(items,cb){return items.map(function(v){return v.items&&(v.items=mapRecursive(v.items,cb)),v=cb(v)})},isAllChecked=function(items){return items.length&&_.all(items,function(vv){return vv.userData.isChecked})},processChecked=function(items,values){return items.map(function(v){return v.userData=v.userData||{},v.items?(v.items=processChecked(v.items,values),v.userData.isChecked=isAllChecked(v.items)):v.userData.isChecked=_.isBoolean(values)?values:values[v.Id],v})},makeDisabled=function(items,isDisabled){return items.map(function(v){return v.userData=v.userData||{},v.items&&(v.items=makeDisabled(v.items,isDisabled)),v.userData.isDisabled=isDisabled,v})},sortChecked=function(items){return _.sortBy(items,function(v){if(null===v.Id)return-99;var isAnyChecked=Boolean(v.userData.isChecked||v.items&&_.any(items,function(vv){return vv.userData.isChecked})),x=-1*Number(isAnyChecked);return v.items&&(v.items=sortChecked(v.items)),x})},ContextInputRow=React.createClass({displayName:"ContextInputRow",render:function(){var v=this.props.item;if(v.userData.isRejected)return null;var className=cx({"vg-contextinput__rowinner":!0});return React.createElement("div",{className:"vg-contextinput__row"},React.createElement("label",{className:className},React.createElement("div",{className:"vg-contextinput__inputholder"},React.createElement("span",{className:"vg-contextinput__inputwrapper"+(v.Color?" vg-contextinput__inputwrapper-active":""),style:{backgroundColor:v.Color||null}},React.createElement("input",{type:"checkbox",checked:v.userData.isChecked,disabled:v.userData.isDisabled,onChange:this.handleChange}))),React.createElement("div",{className:"vg-contextinput__iconholder"},"Icon"in v?React.createElement("i",{className:"tau-icon tau-icon_type_svg tau-icon_name_"+v.Icon,dangerouslySetInnerHTML:{__html:"&nbsp;"}}):null),React.createElement("div",{className:"vg-contextinput__label"+(v.items?" vg-contextinput__label-category":"")},React.createElement("span",{className:"vg-contextinput__labeltext"},v.Name))),v.items?React.createElement(ContextInputList,{ref:"list",items:v.items,onChange:this.handleChangeList}):null)},handleChange:function(){this.props.item.items&&(this.props.item.items=processChecked(this.props.item.items,!this.props.item.userData.isChecked)),this.props.onChange(this.props.item,!this.props.item.userData.isChecked)},handleChangeList:function(items){this.props.onChange(this.props.item,isAllChecked(items))}});ContextInputList=React.createClass({displayName:"ContextInputList",render:function(){var items=this.props.items;return React.createElement("div",{className:"vg-contextinput__list"},items.map(function(v){return React.createElement(ContextInputRow,{key:v.Id||"k00",item:v,onChange:this.handleChange})}.bind(this)))},handleChange:function(item,isChecked){item.userData.isChecked=isChecked,this.props.onChange(this.props.items)}});var ContextInputColumn=React.createClass({displayName:"ContextInputColumn",getInitialState:function(){var ids=_.pluck(this.props.defaultValue.items,"Id"),isAll=Boolean(this.props.defaultValue.all),values=_.object(this.props.items.map(function(v){return[v.Id,isAll?!0:ids.indexOf(v.Id)>=0]})),items=this.props.groupedItems||this.props.items;return items=processChecked(items,values),items=makeDisabled(items,this.props.disabled),items=sortChecked(items),{items:items,valueAll:isAllChecked(items)}},render:function(){var search=this.props.search,items=sortChecked(this.state.items);items=mapRecursive(this.state.items,function(v){return v.userData.isRejected=search&&v.Name.toLowerCase().indexOf(search)<0,v.items&&(v.userData.isRejected=v.userData.isRejected&&_.all(v.items,function(vv){return vv.userData.isRejected})),v});var isAllRejected=search&&_.all(items,function(v){return v.userData.isRejected}),allItem={Name:this.props.title,userData:{isChecked:this.state.valueAll,isDisabled:this.props.disabled}};return React.createElement("div",{className:"vg-contextinput__col "+this.props.className},React.createElement("div",{className:"vg-contextinput__list vg-contextinput__header"},React.createElement(ContextInputRow,{item:allItem,onChange:this.handleChangeAll})),isAllRejected?React.createElement("div",{className:"vg-contextinput__searchemptyresult"},this.props.searchEmptyResultPlaceholder):React.createElement(ContextInputList,{ref:"list",items:items,onChange:this.handleChange}))},handleChange:function(items){this.setState({valueAll:isAllChecked(items),items:items})},handleChangeAll:function(){var val=!this.state.valueAll;this.setState({valueAll:val,items:processChecked(this.state.items,val)})},getValue:function(){var flattenItems=function(itemsToFlat){return itemsToFlat.reduce(function(res,v){return res=res.concat(v.items?flattenItems(v.items):v)},[])},items=flattenItems(this.state.items),all=this.state.valueAll,checked=_.filter(items,function(v){return v.userData.isChecked});return checked.length||(all=!0,checked=items),items=checked.map(function(v){return _.omit(v,"userData")}),{all:all,items:items}}}),ContextInput=React.createClass({displayName:"ContextInput",getInitialState:function(){return{isLoading:!0}},componentDidMount:function(){var loadProjects=restApi.load("projects",{include:restApi.wrapInclude(["Id","Name","Color","NumericPriority","IsActive",{Process:["Id"]},{Program:["Id","Name","NumericPriority"]}]),orderBy:"Name",where:'(IsActive eq "True")'}),loadTeams=restApi.load("teams",{include:restApi.wrapInclude(["Id","Name","Icon"])}).then(function(teams){var noTeam={Id:null,Name:"No team"};return[noTeam].concat(teams)});$.when(loadProjects,loadTeams).then(function(projects,teams){this.setState({projects:projects,teams:teams,isLoading:!1})}.bind(this))},render:function(){if(this.state.isLoading)return null;var groupedProjects=_.groupBy(this.state.projects,function(v){return v.Program?v.Program.Id:"none"});groupedProjects=(groupedProjects.none||[]).concat(_.reduce(groupedProjects,function(res,v,k){if("none"!==k){var prog=v[0].Program;prog.items=v,res=res.concat(prog)}return res},[])),groupedProjects=_.sortBy(groupedProjects,function(v){return v.Name.toLowerCase()});var teams=this.state.teams;_.all(teams,function(v){return!v.Icon})&&(teams=teams.map(function(v){return _.omit(v,"Icon")}));var showSearch=!this.props.disabled&&(this.state.projects.length>10||this.state.teams.length>10),className=cx({"vg-contextinput":!0,"disabled vg-contextinput-disabled":this.props.disabled});return React.createElement("div",{className:className},showSearch?React.createElement("div",{className:"vg-contextinput__search"},React.createElement("div",{className:"tau-inline-group tau-search"},React.createElement("input",{className:"tau-in-text",ref:"search",type:"text",placeholder:"Search",onChange:this.handleSearch}),React.createElement("button",{type:"button",className:"tau-btn tau-search",onClick:this.handleSearch}))):null,React.createElement("div",{className:"vg-contextinput__cols"},React.createElement(ContextInputColumn,{ref:"projects",className:"vg-contextinput__col-projects",groupedItems:groupedProjects,items:this.state.projects,search:this.state.search,defaultValue:this.props.defaultValue.projects,searchEmptyResultPlaceholder:"No such project found",title:"Projects",disabled:this.props.disabled}),React.createElement(ContextInputColumn,{ref:"teams",className:"vg-contextinput__col-teams",items:teams,search:this.state.search,defaultValue:this.props.defaultValue.teams,searchEmptyResultPlaceholder:"No such team found",title:"Teams",disabled:this.props.disabled})))},handleSearch:function(){var search=this.refs.search.getDOMNode().value.trim().toLowerCase();this.setState({search:search})},getValue:function(){return{projects:this.refs.projects.getValue(),teams:this.refs.teams.getValue()}}});return module.exports=ContextInput,module.exports}),define("ViewGallery/CustomFieldsEditor",function(require,exports,module){var React=require("react"),cx=React.addons.classSet,_=require("Underscore"),Flx=require("ViewGallery/Flx"),Store=Flx.createStore({load:function(items){this.items=items.map(function(v){return v=_.extend({},v),v.userData={isDisabled:this.isDisabled},v}.bind(this)),this.fireChange()},getValue:function(){return this.items.map(function(v){return _.omit(v,"userData")})},save:function(item,value){item.userData.tmpValue=null,item.Value=_.unique(_.filter(value.split(/\r?\n/).map(function(v){return v.trim()}),function(v){return v&&v.length})).join("\r\n"),this.fireChange()},focus:function(item){item.userData.isDisabled||(item.userData.isHover=!1,item.userData.isFocus=!0,this.fireChange())},blur:function(item){item.userData.isDisabled||(item.userData.isFocus=!1,this.fireChange())},hover:function(item){item.userData.isDisabled||item.userData.isFocus||(item.userData.isHover=!item.userData.isHover,this.fireChange())},saveTmpValue:function(item,value){item.userData.tmpValue=value,this.fireChange()}}),CustomFieldsEditorInput=React.createClass({displayName:"CustomFieldsEditorInput",render:function(){var item=this.props.item,className=cx({"vg-forminput":!0,"vg-customfieldseditor__input":!0,"vg-customfieldseditor__input-focus":item.userData.isFocus,"vg-customfieldseditor__input-hover":item.userData.isHover});return React.createElement("div",{className:className},React.createElement("label",null,item.Name,React.createElement("div",{className:"vg-customfieldseditor__inputwrapper"},item.userData.isHover?React.createElement("i",{className:"vg-icon vg-icon-pencil"}):null,React.createElement("textarea",{ref:"textarea",value:item.userData.tmpValue||item.Value,disabled:item.userData.isDisabled,onFocus:this.handleFocus,onBlur:this.handleBlur,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,onChange:this.handleChange}))))},handleMouseEnter:function(){this.props.store.hover(this.props.item)},handleMouseLeave:function(){this.props.store.hover(this.props.item)},handleFocus:function(){this.props.store.focus(this.props.item)},handleBlur:function(){this.props.store.save(this.props.item,this.refs.textarea.getDOMNode().value),this.props.store.blur(this.props.item)},handleChange:function(){this.props.store.saveTmpValue(this.props.item,this.refs.textarea.getDOMNode().value)}}),CustomFieldsEditor=React.createClass({displayName:"CustomFieldsEditor",mixins:[Flx.Mixin],getInitialState:function(){return{store:new Store}},componentDidMount:function(){this.state.store.isDisabled=this.props.disabled,this.state.store.load(this.props.items)},render:function(){var cfs=this.state.store.items;if(!cfs)return null;var className=cx({"vg-customfieldseditor":!0,"disabled vg-customfieldseditor-disabled":this.state.store.isDisabled});return React.createElement("div",{className:className},cfs.map(function(v,k){return React.createElement(CustomFieldsEditorInput,{item:v,key:"k"+k,store:this.state.store})}.bind(this)))},getValue:function(){return this.state.store.getValue()}});return module.exports=CustomFieldsEditor,module.exports}),define("ViewGallery/CustomFieldsSelect",function(require,exports,module){var _=require("Underscore"),$=require("jQuery"),React=require("react"),store=require("ViewGallery/restApi"),CustomFieldsSelect=React.createClass({displayName:"CustomFieldsSelect",getInitialState:function(){return{items:[]}},componentDidMount:function(){store.load("Processes",{include:store.wrapInclude(["Name",{CustomFields:["Id","Name","Value","EntityFieldName","FieldType","EnabledForFilter","Required",{EntityType:["Id","Name"]},"Config"]}]),orderBy:"Name"}).then(function(items){var customFields=items.reduce(function(res,v){return res.concat(v.CustomFields)},[]),external=_.reject(this.props.defaultValue,function(cf1){return _.any(customFields,function(cf2){return cf1.Id===cf2.Id&&cf1.FieldType===cf2.FieldType})});if(external.length){var externalProcess={Id:"external",Name:"*External*",CustomFields:external};customFields=customFields.concat(external),items=[externalProcess].concat(items)}this.setState({items:items,customFields:customFields})}.bind(this))},render:function(){var processes=this.state.items;if(!processes.length)return null;var disabled=this.props.disabled,ids=_.pluck(this.props.defaultValue||[],"Id");if(!this.state.customFields.length)return null;var inner=_.filter(processes,function(v){return v.CustomFields.length}).map(function(process){var fields=process.CustomFields.map(function(cf,k){return React.createElement("div",{className:"vg-customfieldselect__field",key:"cf"+k},React.createElement("label",null,React.createElement("input",{type:"checkbox",value:cf.Id,key:"cf"+cf.Id,disabled:disabled,defaultChecked:ids.indexOf(cf.Id)>=0?!0:null}),cf.Name,React.createElement("span",{className:"tau-entity-icon tau-entity-icon--"+cf.EntityType.Name.toLowerCase().replace(" ","")},cf.EntityType.Name)))});return React.createElement("div",{className:"vg-customfieldselect__process",key:"pr"+process.Id},React.createElement("div",{className:"vg-customfieldselect__processname"},process.Name),fields)});return React.createElement("div",React.__spread({},this.props,{className:"vg-customfieldselect"+(this.props.disabled?" disabled":"")}),inner)},getValue:function(){var ids=$(this.getDOMNode()).find(":checked").toArray().map(function(v){return parseInt(v.value,10)}),fields=_.filter(this.state.customFields,function(v){return ids.indexOf(v.Id)>=0});return fields}});return module.exports=CustomFieldsSelect,module.exports}),define("ViewGallery/ExternalTrigger",function(require,exports,module){var React=require("react"),cx=React.addons.classSet,ExternalTrigger=React.createClass({displayName:"ExternalTrigger",componentDidMount:function(){this.listener=function(){this.forceUpdate()}.bind(this),this.props.store.on("change",this.listener)},componentWillUnmount:function(){this.props.store.removeListener("change",this.listener)},render:function(){var isActive=this.props.store.isActive,className=cx({"t3-view t3-grid vg-externaltrigger":!0,"vg-externaltrigger-disabled":!isActive});return React.createElement("div",{className:className},React.createElement("div",{className:"t3-header",onClick:this.handleClick},React.createElement("i",{className:"vg-icon vg-icon-gallery"}),React.createElement("div",{className:"t3-name vg-externaltrigger__name"},this.props.children||"Browse Solutions Gallery")))},handleClick:function(){this.props.store.activate()}});return module.exports=ExternalTrigger,module.exports}),define("ViewGallery/FeedbackForm",function(require,exports,module){var React=require("react"),Overlay=require("ViewGallery/Overlay"),FeedbackForm=React.createClass({displayName:"FeedbackForm",render:function(){var inner;return inner="success"===this.props.store.feedbackStatus?React.createElement("div",{className:"vg-feedback__innersuccess"},React.createElement("h1",null,"Thanks!"),React.createElement("p",null,"We'll be in touch shortly."),React.createElement("a",{className:"vg-feedback__close",onClick:this.handleCancel},"Close this window")):React.createElement("div",null,React.createElement("h1",null,"Can't find the view you need?"),React.createElement("p",null,"Just let us know! We'll be happy to help create it, so it can be added in one click."),React.createElement("form",{onSubmit:this.handleSubmit},React.createElement("div",{className:"vg-forminput"},React.createElement("textarea",{ref:"message",autoFocus:!0,placeholder:""})),React.createElement("div",{className:"vg-buttons"},React.createElement("button",{className:"vg-btn vg-btn-success",type:"submit"},"Send"),React.createElement("a",{className:"vg-cancellink",onClick:this.handleCancel},"Cancel")))),React.createElement(Overlay,{onClose:this.handleClose,scrollable:!1},React.createElement("div",{className:"vg-feedback"},inner))},handleClose:function(){this.props.store.cancelFeedback()},handleCancel:function(){this.props.store.cancelFeedback()},handleSubmit:function(e){e.preventDefault();var value=this.refs.message.getDOMNode().value;this.props.store.submitFeedback(value)}});return module.exports=FeedbackForm,module.exports}),define("ViewGallery/FileInput",function(require,exports,module){var React=require("react"),cx=React.addons.classSet,resize=function(file,width,height,isFixed){var fileType=file.type,reader=new FileReader,defer=new $.Deferred;return reader.onloadend=function(){var image=new Image;image.src=reader.result;var ratio=2,canvas=document.createElement("canvas");image.onload=function(){var ctx,maxWidth=width,maxHeight=height,imageWidth=image.width,imageHeight=image.height;isFixed?(imageWidth>imageHeight?imageWidth>maxWidth&&(imageHeight*=maxWidth/imageWidth,imageWidth=maxWidth):imageHeight>maxHeight&&(imageWidth*=maxHeight/imageHeight,imageHeight=maxHeight),ctx=canvas.getContext("2d"),canvas.width=maxWidth*ratio,canvas.height=maxHeight*ratio,ratio>1&&ctx.scale(ratio,ratio),ctx.drawImage(this,-(maxWidth-imageWidth)/2,-(imageHeight-maxHeight)/2,imageWidth,imageHeight)):(ratio=1,ctx=canvas.getContext("2d"),canvas.width=imageWidth*ratio,canvas.height=imageHeight*ratio,ratio>1&&ctx.scale(ratio,ratio),ctx.drawImage(this,0,0,imageWidth,imageHeight));var finalFile=canvas.toDataURL(fileType);return defer.resolve({file:file,resizeData:finalFile})}},reader.readAsDataURL(file),defer},FileInput=React.createClass({displayName:"FileInput",getInitialState:function(){return{value:this.props.defaultValue,preview:this.props.defaultValue,clearValue:null}},render:function(){var preview;this.state.preview&&(preview=React.createElement("img",{src:this.state.preview}));var buttons,className=cx({"vg-fileinput":!0,"vg-fileinput-fit":this.props.fitImage}),addButton=React.createElement("button",{type:"button",className:"vg-btn"},this.props.children);return buttons=this.state.preview&&this.props.allowRemove?React.createElement("div",{className:"vg-btn-group"},addButton,React.createElement("button",{type:"button",className:"vg-btn",onClick:this.handleClear},React.createElement("i",{className:"vg-icon vg-icon-bin"}))):addButton,React.createElement("div",{className:className,onClick:this.handleClick},preview,React.createElement("div",{className:"vg-buttonholder"},buttons),React.createElement("input",{type:"file",ref:"input",accept:"image/*",hidden:!0,onChange:this.handleChange}))},handleClick:function(){$(this.refs.input.getDOMNode()).trigger("click")
},handleClear:function(e){e.preventDefault(),e.stopPropagation(),this.setState({value:null,preview:null,clearValue:!0},function(){this.props.onChange&&this.props.onChange(null)}.bind(this))},handleChange:function(){$.when(this.getFile()).then(function(res){this.setState({value:res,preview:res?res.resizeData:null,clearValue:!1},function(){this.props.onChange&&this.props.onChange(res)}.bind(this))}.bind(this))},getFile:function(){var input=this.refs.input.getDOMNode();if(input.files&&input.files[0]){var file=input.files[0];return resize(file,this.props.width,this.props.height,this.props.fitImage)}return null},getValue:function(){return{file:this.state.value,isClear:this.state.clearValue}}});return module.exports=FileInput,module.exports}),define("ViewGallery/FileInputMultiple",function(require,exports,module){var $=require("jQuery"),React=require("react"),Flx=require("ViewGallery/Flx"),FileInputMultipleIndicator=require("ViewGallery/FileInputMultipleIndicator"),FileInputMultipleItem=require("ViewGallery/FileInputMultipleItem"),FileInputMultiple=React.createClass({displayName:"FileInputMultiple",mixins:[Flx.Mixin],componentDidUpdate:function(){var $inner=$(this.refs.inner.getDOMNode());$inner.animate({scrollLeft:this.props.store.activeIndex*$inner[0].getBoundingClientRect().width})},render:function(){var store=this.props.store;if(!store)return null;var indicators,items=this.props.store.items,imgs=items.map(function(v,k){return React.createElement("div",{className:"vg-carousel__item",key:v.id||"zero"+k},React.createElement(FileInputMultipleItem,{item:v,store:store}))}),indicatorItems=items.map(function(v,k){return React.createElement(FileInputMultipleIndicator,{item:v,store:store,key:v.id||"zero"+k,index:k,draggingIndex:store.draggingIndex,sort:this.handleSort,sortStarted:this.handleSortStarted,sortCompleted:this.handleSortCompleted})}.bind(this));return indicators=React.createElement("div",{className:"vg-carousel__indicators",onDrop:this.handleDrop},indicatorItems),React.createElement("div",{className:"vg-carousel vg-carousel-input"},React.createElement("div",{className:"vg-carousel__inner",ref:"inner"},imgs),indicators)},handleSort:function(from,to){this.props.store.reorder(from,to)},handleSortStarted:function(index){this.props.store.startSort(index)},handleSortCompleted:function(){},handleDrop:function(e){e.preventDefault(),e.stopPropagation()},getValue:function(){return this.props.store.getValue()}});return module.exports=FileInputMultiple,module.exports}),define("ViewGallery/FileInputMultipleIndicator",function(require,exports,module){var React=require("react"),cx=React.addons.classSet,SortableMixin=require("ViewGallery/SortableMixin"),FileInputMultipleIndicator=React.createClass({displayName:"FileInputMultipleIndicator",mixins:[SortableMixin],render:function(){var item=this.props.item;if(!item.id)return React.createElement("div",{className:"vg-carousel__indicator vg-carousel__indicator-add",onClick:this.handleStartAdd,draggable:!1,"data-index":null},React.createElement("i",{className:"vg-icon vg-icon-plus"}));var className=cx({"vg-carousel__indicator":!0,"vg-carousel__indicator-active":item.userData.isSelected});return React.createElement("div",{className:className,onClick:this.handleClick,draggable:!0,"data-index":this.props.index,onDragStart:this.handleDragStart,onDragEnd:this.handleDragEnd,onDragOver:this.handleDragOver},React.createElement("img",{src:item.file}))},handleClick:function(){this.props.store.select(this.props.item)},handleStartAdd:function(){this.props.store.select(this.props.item)}});return module.exports=FileInputMultipleIndicator,module.exports}),define("ViewGallery/FileInputMultipleItem",function(require,exports,module){var React=require("react"),FileInput=require("ViewGallery/FileInput"),FileInputMultipleItem=React.createClass({displayName:"FileInputMultipleItem",render:function(){var item=this.props.item;return React.createElement(FileInput,{width:892,height:524,defaultValue:item.file,onChange:this.handleChange,allowRemove:!0},"Load screenshot (892×524)")},handleChange:function(val){val?this.props.store.update(this.props.item,val):this.props.store.remove(this.props.item)}});return module.exports=FileInputMultipleItem,module.exports}),define("ViewGallery/ImportButton",function(require,exports,module){var React=require("react"),ReactCSSTransitionGroup=React.addons.CSSTransitionGroup,$=require("jQuery"),_=require("Underscore"),ImportTooltip=require("ViewGallery/ImportTooltip"),ImportWizard=require("ViewGallery/ImportWizard"),Tooltip=require("ViewGallery/Tooltip"),Button=require("ViewGallery/Button"),boardCreator=require("ViewGallery/boardCreator"),ImportButtom=React.createClass({displayName:"ImportButtom",loadData:function(){var item=this.props.item,type=this.props.type;return $.when("solution"===type?boardCreator.getSolutionImportRestrictions(item):boardCreator.getViewImportRestrictions(item,this.props.store.solution)).then(function(code){item.userData.importRestrictions=code,this.forceUpdate()}.bind(this))},componentDidMount:function(){this.loadData()},componentDidUpdate:function(prevProps){prevProps.item.objectId===this.props.item.objectId&&this.props.item.userData.importRestrictions||this.loadData()},render:function(){var importWizard,item=this.props.item,importRestrictions=item.userData.importRestrictions,type=this.props.type;item.userData.importStatus&&(importWizard=React.createElement(ImportWizard,{item:item,store:this.props.store,type:type,onConfirm:this.props.onConfirm,onCancel:this.props.onCancel}));var importRestrictionsTooltip;if(item.userData.showImportRestrictions&&!item.userData.importStatus)if(importRestrictions&&importRestrictions.code&&importRestrictions.disabled)importRestrictionsTooltip=React.createElement(ImportTooltip,{item:item});else if("view"===type)importRestrictionsTooltip=React.createElement(Tooltip,{orientation:"top",className:"vg-importbubble vg-importbubble-info"},"A new private ",item.userData.itemTypeTitle," will be created in your Targetprocess account.");else if("solution"===type){var count=_.filter(item.views,function(v){return v.objectId}).length;importRestrictionsTooltip=React.createElement(Tooltip,{orientation:"top",className:"vg-importbubble vg-importbubble-info"},"A private folder with ",count," ",1===count?"view":"views"," ","will be created in your Targetprocess account.")}var isDisabledButton=importRestrictions&&importRestrictions.disabled;return React.createElement("div",{className:"vg-importbuttonwrapper"},React.createElement(Button,{onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,loaderActive:item.userData.isCreating,loaderProgress:item.userData.createProgress,className:"vg-btn vg-btn-success vg-importbutton"+(isDisabledButton?" disabled":""),onClick:isDisabledButton?null:this.props.onClick},this.props.children),importRestrictionsTooltip,React.createElement(ReactCSSTransitionGroup,{transitionName:"vg-overlay-animation",scrollable:!0},importWizard))},handleMouseEnter:function(){this.props.store.toggleShowImportRestrictions(this.props.item,!0)},handleMouseLeave:function(){this.props.store.toggleShowImportRestrictions(this.props.item,!1)}});return module.exports=ImportButtom,module.exports}),define("ViewGallery/ImportTooltip",function(require,exports,module){var React=require("react"),_=require("Underscore"),Tooltip=require("ViewGallery/Tooltip"),Join=require("ViewGallery/Join"),ImportTooltip=React.createClass({displayName:"ImportTooltip",render:function(){var item=this.props.item,importRestrictions=item.userData.importRestrictions,isSolution=Boolean(item.views),type=isSolution?"solution":"view",itemTypeTitle=item.userData.itemTypeTitle||type,message={"no-process":function(){var processName=importRestrictions.process.Name;return React.createElement("span",null,"The process ",React.createElement(Join,{list:processName})," and a project, related to this process,"," ","must exist in your system in order to use this ",itemTypeTitle,". Please contact your administrator."," ","Additional details are available from the ",itemTypeTitle," prerequisites.")},"no-any-process":function(){return React.createElement("span",null,"There is no any process with at least one available project now."," ","Please contact your administrator"," ","or create project yourself."," ","Additional details are available from the ",itemTypeTitle," prerequisites.")},"no-project":function(){var processName=importRestrictions.process.Name;return React.createElement("span",null,"The process ",React.createElement(Join,{list:processName})," and a project, related to this process,"," ","must exist in your system in order to use this ",itemTypeTitle,". Please contact your administrator."," ","Additional details are available from the ",itemTypeTitle," prerequisites.")},"no-customfields":function(){var names=_.pluck(importRestrictions.views,"title"),cfNames=_.pluck(importRestrictions.customFields,"Name"),isSingle=1===names.length,typeName=isSingle?"view":"views",isCfSingle=1===_.unique(cfNames).length,cfName=isCfSingle?"field":"fields";return"solution"===type&&names.length?React.createElement("span",null,React.createElement(Join,{list:cfNames})," ",isCfSingle?"is a":"are"," ","required custom ",cfName," for the"," ",React.createElement(Join,{list:names})," ",typeName,"."," ","Please contact your administrator"," ","or install the solution without ",isSingle?"this":"these"," ",typeName,"."," ","Additional details are available from the ",itemTypeTitle," prerequisites."):React.createElement("span",null,React.createElement(Join,{list:cfNames})," ",isCfSingle?"is a":"are"," ","required custom ",cfName," for this ",itemTypeTitle,"."," ","Please contact your administrator."," ","Additional details are available from the ",itemTypeTitle," prerequisites.")}}[importRestrictions.code]();return React.createElement(Tooltip,{orientation:"top",className:"vg-importbubble vg-importbubble-restrictions"},message)}});return module.exports=ImportTooltip,module.exports}),define("ViewGallery/ImportWizard",function(require,exports,module){var React=require("react"),_=require("Underscore"),configurator=require("tau/configurator"),Overlay=require("ViewGallery/Overlay"),Join=require("ViewGallery/Join"),ContextInput=require("ViewGallery/ContextInput"),CustomFieldsEditor=require("ViewGallery/CustomFieldsEditor"),Button=require("ViewGallery/Button"),boardCreator=require("ViewGallery/boardCreator"),StickyHeaderMixin=require("ViewGallery/StickyHeaderMixin"),ImportWizard=React.createClass({displayName:"ImportWizard",mixins:[StickyHeaderMixin],render:function(){var type=this.props.type,item=this.props.item,importRequired="solution"===type?boardCreator.getSolutionFullImportData(item):boardCreator.getViewFullImportData(item,this.props.store.solution);importRequired=importRequired||{};var contextMessage,customFieldsMessage,contextInput,customFieldsEditor,isAdministrator=configurator.getLoggedUser().isAdministrator,importData=item.userData.importData,customFieldsValue=importData.customFields,itemTypeTitle=item.userData.itemTypeTitle;if(importRequired.process){var projects;if(isAdministrator){if("new-process-and-new-project"===item.userData.importStatus)contextMessage=React.createElement("span",null,"A new process ",React.createElement(Join,null,importData.process.Name)," ","and a new project ",React.createElement(Join,null,importData.project.Name)," ","will be created in your account to make this ",itemTypeTitle," working."," ","Additional details are available from the ",itemTypeTitle," prerequisites.");else if("existing-process-and-existing-projects"===item.userData.importStatus)projects=_.pluck(item.userData.importData.projects,"Name"),contextMessage=React.createElement("span",null,"The process ",React.createElement(Join,null,item.userData.importData.process.Name)," ",projects.length?"and the "+(1===projects.length?"project":"projects"):""," ",React.createElement(Join,{list:projects})," ","will be used for this ",itemTypeTitle,"."," ","Additional details are available from the ",itemTypeTitle," prerequisites.");else if("existing-process-and-new-project"===item.userData.importStatus){var projectName=item.userData.importData.project.Name;contextMessage=React.createElement("span",null,"The process ",React.createElement(Join,{list:item.userData.importData.process.Name})," ","will be in use and a new project"," ",React.createElement(Join,{list:projectName})," ","will be created in your account to make this ",itemTypeTitle," working."," ","Additional details are available from the ",itemTypeTitle," prerequisites.")}}else"existing-process-and-existing-projects"===item.userData.importStatus?(projects=_.pluck(item.userData.importData.projects,"Name"),contextMessage=React.createElement("span",null,"The process ",React.createElement(Join,null,item.userData.importData.process.Name)," ",projects.length?"and the "+(1===projects.length?"project":"projects"):""," ",React.createElement(Join,{list:projects})," ","will be used for this ",itemTypeTitle,"."," ")):contextMessage=React.createElement("span",null,"The process ",React.createElement(Join,null,importData.process.Name)," ","and a project, related to this process"," ","must exist in your system in order to use this ",itemTypeTitle,"."," ","Please contact your administrator."," ","Additional details are available from the ",itemTypeTitle," prerequisites.")}else if(importRequired.customFields){var contextValue={projects:{all:importRequired.forceProcesses,items:importData.projects},teams:{all:importRequired.forceProcesses||importData.projects.length&&!importData.teams.length,items:importData.teams}},names=React.createElement(Join,{list:_.pluck(importRequired.customFields,"Name")}),cfLength=_.unique(importRequired.customFields,function(v){return v.Name}).length;if(isAdministrator)importData.projects.length?(customFieldsMessage=React.createElement("span",null,"Custom ",1===cfLength?"field":"fields"," ",names," will be used for the ",itemTypeTitle,"."),contextInput=React.createElement(ContextInput,{ref:"context",defaultValue:contextValue,disabled:!0}),customFieldsEditor=React.createElement(CustomFieldsEditor,{ref:"customFields",items:customFieldsValue,disabled:!0})):(customFieldsMessage=React.createElement("span",null,"Custom ",1===cfLength?"field":"fields"," ",names," will be created in your account."),contextInput=React.createElement(ContextInput,{ref:"context",defaultValue:contextValue,disabled:importRequired.forceProcesses}),customFieldsEditor=React.createElement(CustomFieldsEditor,{ref:"customFields",items:customFieldsValue}));else if(importData.projects.length)customFieldsMessage=React.createElement("span",null,"Custom ",1===cfLength?"field":"fields"," ",names," ","will be used for the ",itemTypeTitle,"."," "),contextInput=React.createElement(ContextInput,{ref:"context",defaultValue:contextValue,disabled:!0}),customFieldsEditor=React.createElement(CustomFieldsEditor,{ref:"customFields",items:customFieldsValue,disabled:!0});else{var importRestrictions=item.userData.importRestrictions,viewNames=React.createElement(Join,{list:_.pluck(importRestrictions.views,"title")});customFieldsMessage="view"===type?React.createElement("span",null,names," ",1===cfLength?"is a":"are"," required custom "," ",1===cfLength?"field":"fields","  for this ",itemTypeTitle,"."," ","Please contact your administrator."," ","Additional details are available from the ",type," prerequisites."):React.createElement("span",null,names," ",1===cfLength?"is a":"are"," required custom "," ",1===cfLength?"field":"fields","  for"," ",1===importRestrictions.views.length?"view":"views"," ",viewNames,"."," ","Please contact your administrator  or install the solution without"," ",1===importRestrictions.views.length?"this view":"these views","."," ","Additional details are available from the ",itemTypeTitle," prerequisites.")}}else if("context"===item.userData.importStatus){var val={projects:{items:importData.projects},teams:{items:importData.teams}};contextInput=React.createElement(ContextInput,{ref:"context",defaultValue:val,disabled:importRequired.forceProcesses})}var context;context=contextInput?React.createElement("div",{className:"vg-importwizard__section vg-importwizard__section-context"},React.createElement("div",{className:"vg-importwizard__message"},contextMessage," ","The ",itemTypeTitle," will be created for the selected below teams and projects."),contextInput):React.createElement("div",null,contextMessage);var customFields;return customFields=customFieldsEditor?React.createElement("div",{className:"vg-importwizard__section vg-importwizard__section-cfs"},React.createElement("div",{className:"vg-importwizard__message"},customFieldsMessage," ","The following values will be used in the custom fields."),customFieldsEditor):React.createElement("div",null,customFieldsMessage),React.createElement(Overlay,{onClose:this.props.onCancel,className:"vg-overlay-importwizard"},React.createElement("div",{ref:"header",className:"vg-viewer__header vg-viewer__header-import vg-viewer__header-sticky"},React.createElement("h2",null,item.title),React.createElement("div",{className:"vg-viewer__tools"},React.createElement(Button,{className:"vg-btn vg-btn-ghost vg-btn-cancel",onClick:this.handleCancel},"Cancel"),React.createElement(Button,{className:"vg-btn vg-btn-success",onClick:this.handleConfirm},"Continue"))),React.createElement("div",{ref:"inner",className:"vg-viewlist__itemfull vg-viewlist__itemfull-overlay vg-viewer vg-importwizard"},context,customFields))},handleConfirm:function(){this.refs.context?this.props.onConfirm({context:this.refs.context.getValue(),customFields:this.refs.customFields?this.refs.customFields.getValue():[]}):this.props.onConfirm()},handleCancel:function(){this.props.onCancel()}});return module.exports=ImportWizard,module.exports}),define("ViewGallery/Join",function(require,exports,module){var React=require("react"),_=require("Underscore"),Join=React.createClass({displayName:"Join",render:function(){var res;if(this.props.list){var arr=_.isArray(this.props.list)?this.props.list:[this.props.list];arr=_.uniq(arr);var len=arr.length;res=arr.map(function(v,k){var sep;return sep=k===len-1?"":k===len-2?" and ":", ",React.createElement("span",{key:"j"+k},React.createElement("em",null,v),sep)})}else res=React.createElement("em",null,this.props.children);return React.createElement("span",null,res)}});return module.exports=Join,module.exports}),define("ViewGallery/MarkdownOutput",function(require,exports,module){var React=require("react"),$=require("jQuery"),setTargets=function(node){$(node).find("a").toArray().map(function(v){$(v).attr("target","_blank")})},MarkdownOutput=React.createClass({displayName:"MarkdownOutput",componentDidMount:function(){setTargets(this.getDOMNode())},componentDidUpdate:function(){setTargets(this.getDOMNode())},render:function(){return this.props.html?React.createElement("div",{className:"vg-markdown",dangerouslySetInnerHTML:{__html:this.props.html}}):React.createElement("div",{className:"vg-markdown"},this.props.children)}});return module.exports=MarkdownOutput,module.exports}),define("ViewGallery/MarkdownTextarea",function(require,exports,module){var React=require("react"),markdown=require("ViewGallery/markdown"),MarkdownTextarea=React.createClass({displayName:"MarkdownTextarea",getInitialState:function(){return{preview:!1,value:this.props.defaultValue}},render:function(){var preview;this.state.preview&&(preview=React.createElement("div",{className:"vg-markdown",dangerouslySetInnerHTML:{__html:markdown.toHtml(this.state.value)}}));var style={display:this.state.preview?"none":""},textarea=React.addons.cloneWithProps(React.createElement("textarea",{onChange:this.handleChange,style:style,value:this.state.value}),this.props);return React.createElement("div",{className:"vg-markdown-textarea"},React.createElement("a",{className:"vg-markdown-textarea__trigger",onClick:this.handleTogglePreview},this.state.preview?"Edit":"Preview"),preview,textarea)},handleChange:function(e){this.setState({value:e.target.value})},handleTogglePreview:function(){this.setState({preview:!this.state.preview})},getValue:function(){return this.state.value||""}});return module.exports=MarkdownTextarea,module.exports}),define("ViewGallery/Overlay",function(require,exports,module){var React=require("react"),cx=React.addons.classSet,Overlay=React.createClass({displayName:"Overlay",getDefaultProps:function(){return{scrollable:!0,stretch:!0}},render:function(){var contentClassName={"vg-overlay__content":!0,"vg-overlay__content-scrollable":this.props.scrollable,"vg-overlay__content-nonscrollable":!this.props.scrollable};return this.props.className&&(contentClassName[this.props.className+"__content"]=!0),contentClassName=cx(contentClassName),React.createElement("div",{className:"vg-overlay "+(this.props.className||""),onClick:this.handleClose},React.createElement("div",{className:"vg-overlay__inner",ref:"inner",onClick:this.handleClose},React.createElement("i",{className:"vg-icon vg-icon-close vg-overlay__close",onClick:this.handleCloseByIcon,title:"Close"}),React.createElement("div",{className:"vg-overlay__scroll"},React.createElement("div",{ref:"content",onClick:this.props.stretch?null:this.handleClose,className:contentClassName},this.props.children))))},handleClose:function(e){(e.target===this.getDOMNode()||e.target===this.refs.inner.getDOMNode()||!this.props.stretch&&e.target===this.refs.content.getDOMNode())&&(e.stopPropagation(),this.props.onClose())},handleCloseByIcon:function(){this.props.onClose()}});return module.exports=Overlay,module.exports}),define("ViewGallery/Prerequisites",function(require,exports,module){var React=require("react"),_=require("Underscore"),Join=require("ViewGallery/Join"),MarkdownOutput=require("ViewGallery/MarkdownOutput"),Prerequisites=React.createClass({displayName:"Prerequisites",render:function(){var genHeader,genText,item=this.props.item,type=this.props.type,imported=item.userData.fullPrerequisitesData,itemTypeTitle=item.userData.itemTypeTitle||type;if(imported&&imported.customFields&&imported.customFields.length){var cfs=_.pluck(imported.customFields,"Name"),isSingle=1===_.unique(cfs).length;genHeader=React.createElement("h3",null,"The custom ",isSingle?"field":"fields"," ",React.createElement(Join,{list:cfs})," ",isSingle?"is":"are"," required for this ",itemTypeTitle,"."," "),genText=React.createElement("ul",null,React.createElement("li",null,isSingle?"If a custom field with the same name and type exists in your account then the existing custom field will be used for this "+itemTypeTitle+".":"If there are custom fields with the same name and type in your account, then the existing custom fields will be used for this "+itemTypeTitle+"."),React.createElement("li",null,isSingle?"If the custom field does not exist in your account, then a new custom field will be created for the projects that are selected when the "+itemTypeTitle+" is added.":" If the custom fields do not exist in your account, then new custom fields will be created for the projects that are selected when the "+itemTypeTitle+" is added."))}if(imported&&imported.process){var processName=imported.process.Name;genHeader=React.createElement("h3",null,"The ",React.createElement(Join,{list:processName})," process and a project, related to"," ","this process, are required for this ",itemTypeTitle,"."," "),genText=React.createElement("ul",{key:"list"},React.createElement("li",null,"If the ",React.createElement(Join,{list:processName})," process already exists in your account,"," ","then the existing process and the projects related to it will be"," ","used for this ",itemTypeTitle,"."),React.createElement("li",null,"If the ",React.createElement(Join,{list:processName})," process exists,"," ","but there are no related projects,"," ","then a new project ",React.createElement(Join,{list:processName})," will be created in your account."),React.createElement("li",null,"If the ",React.createElement(Join,{list:processName})," process does not exist,"," ","a new process ",React.createElement(Join,{list:processName})," and a related "," ",React.createElement(Join,{list:processName})," project will be created in your account."))}return React.createElement("div",{className:"vg-viewer__prerequisites"},React.createElement("div",{className:"vg-viewer__prerequisitesinner"},React.createElement(MarkdownOutput,null,genHeader,genText),React.createElement(MarkdownOutput,{html:item.prerequisitesHtml})))}});return module.exports=Prerequisites,module.exports}),define("ViewGallery/ProcessSelect",function(require,exports,module){var React=require("react"),_=require("Underscore"),store=require("ViewGallery/restApi"),configurator=require("tau/configurator"),hasTerms=Boolean(configurator.getStore().typeMetaInfo("process").refs.terms),ProcessSelect=React.createClass({displayName:"ProcessSelect",getInitialState:function(){return{items:[]}},componentDidMount:function(){hasTerms?store.load("Processes",{include:store.wrapInclude(["Id","Name"]),take:999,orderBy:"Name"}).then(function(items){this.setState({items:items})}.bind(this)):store.load("Processes",{include:store.wrapInclude(["Id","Name","Projects"]),take:999,orderBy:"Name"}).then(function(items){items=_.filter(items,function(v){return v.Projects.length>0}),this.setState({items:items})}.bind(this))},render:function(){if(!this.state.items.length)return React.createElement("select",{key:"notloaded"});var externalSelected,inner=this.state.items.map(function(v){return React.createElement("option",{key:v.Id,value:v.Id},v.Name)});return this.state.items.length&&this.props.process&&_.pluck(this.state.items,"Id").indexOf(Number(this.props.defaultValue))<0&&(externalSelected=React.createElement("option",{value:this.props.defaultValue},this.props.process.Name," (external)")),React.createElement("select",React.__spread({},this.props),React.createElement("option",{value:"",key:"0"},"No process"),externalSelected,inner)}});return module.exports=ProcessSelect,module.exports}),define("ViewGallery/SearchInput",function(require,exports,module){var React=require("react"),cx=React.addons.classSet,SearchInput=React.createClass({displayName:"SearchInput",render:function(){var store=this.props.store,className=cx({"vg-forminput":!0,"vg-searchinput":!0,"vg-searchinput-value":Boolean(store.filterText)});return React.createElement("div",{className:className},React.createElement("span",{className:"vg-searchinput__tool vg-searchinput__loop",onClick:this.handleFocus,title:"Search"},React.createElement("i",{className:"vg-icon vg-icon-loop"})),React.createElement("input",{type:"text",className:"vg-searchinput__input",onChange:this.handleFilter,value:store.filterText,ref:"input",title:"Search"}),React.createElement("span",{className:"vg-searchinput__tool vg-searchinput__reset",onClick:this.handleReset,title:"Clear"},React.createElement("i",{className:"vg-icon vg-icon-close-sm"})))},handleFilter:function(e){this.props.store.filter(e.target.value)},handleReset:function(){this.props.store.filter(""),this.refs.input.getDOMNode().focus()},handleFocus:function(){this.refs.input.getDOMNode().focus()}});return module.exports=SearchInput,module.exports}),define("ViewGallery/SolutionFolder",function(require,exports,module){var React=require("react"),cx=React.addons.classSet,SolutionInnerList=require("ViewGallery/SolutionInnerList"),SolutionFolderForm=require("ViewGallery/SolutionFolderForm"),Confirmation=require("ViewGallery/Confirmation"),SortableMixin=require("ViewGallery/SortableMixin"),SolutionFolder=React.createClass({displayName:"SolutionFolder",mixins:[SortableMixin],render:function(){var confirmation,store=this.props.store,item=this.props.item,permissions=this.props.store.permissions;item.userData.isWaitingConfirmation&&(confirmation=React.createElement(Confirmation,{orientation:"top",onConfirm:this.handleConfirmRemove,onCancel:this.handleCancelRemove},"Do you really want to remove this Folder?"));var inner;if(item.userData.isEditing)inner=React.createElement(SolutionFolderForm,{item:item,store:store});else{var innerClassName=cx({"vg-list__iteminner":!0,"vg-list__iteminner-hover":item.userData.isWaitingConfirmation});inner=React.createElement("div",{className:innerClassName,onDoubleClick:this.handleDoubleClick},React.createElement("div",{className:"vg-list__itemname vg-list__itemname-folder",onClick:this.handleToggleCollapse},React.createElement("i",{className:"vg-icon vg-icon-folder"}),React.createElement("div",{className:"vg-list__itemtitle vg-list__itemtitle-folder"},item.title)),React.createElement("div",{className:"vg-list__itemtools"},permissions.add?React.createElement("i",{className:"vg-icon vg-icon-plus",onClick:this.handleStartAdd,title:"Add Solution"}):null,permissions.add?React.createElement("i",{className:"vg-icon vg-icon-folder-plus",onClick:this.handleAddFolder,title:"Add Folder"}):null,permissions.remove?React.createElement("i",{className:"vg-icon vg-icon-bin",onClick:this.handleRemove,title:"Remove"}):null,confirmation))}var isDraggable=!this.props.item.userData.isEditing&&permissions.edit,className=cx({"vg-list__item":!0,"vg-list__folder":!0,"vg-list__item-hidden":item.isHidden,"vg-list__item-selected":item.userData.isSelected,"vg-list__item-hover":item.userData.isWaitingConfirmation,"vg-list__item-dragging":item.userData.isDragging,"vg-list__item-isnotmatching":!item.userData.isMatchFilter});return React.createElement("div",{className:className,draggable:isDraggable||null,"data-index":this.props.index,onDragStart:this.handleDragStart,onDragEnd:this.handleDragEnd,onDragOver:this.handleDragOver},inner,React.createElement("div",{className:"vg-list__folderchildren vg-list__folderchildren-lev"+item.userData.level},item.userData.isExpanded?React.createElement(SolutionInnerList,React.__spread({items:item.items},this.props)):null))},handleToggleCollapse:function(){this.props.store.toggleCollapseFolder(this.props.item)},handleDoubleClick:function(){this.props.store.startEdit(this.props.item)},handleRemove:function(){this.props.store.startRemove(this.props.item)},handleConfirmRemove:function(){this.props.store.remove(this.props.item)},handleCancelRemove:function(){this.props.store.cancelRemove(this.props.item)},handleStartAdd:function(){this.props.store.startAdd(this.props.item)},handleAddFolder:function(){this.props.store.addFolder(this.props.item)}});return module.exports=SolutionFolder,module.exports}),define("ViewGallery/SolutionFolderForm",function(require,exports,module){var React=require("react"),SolutionFolderForm=React.createClass({displayName:"SolutionFolderForm",render:function(){return React.createElement("form",{className:"vg-solutionfolderform",onSubmit:this.handleSubmit},React.createElement("input",{type:"text",ref:"title",autoFocus:!0,onBlur:this.handleBlur,defaultValue:this.props.item.title}))},handleSubmit:function(e){e.preventDefault(),this.props.store.save(this.props.item,this.refs.title.getDOMNode().value)},handleBlur:function(){this.props.store.save(this.props.item,this.refs.title.getDOMNode().value)}});return module.exports=SolutionFolderForm,module.exports}),define("ViewGallery/SolutionGroup",function(require,exports,module){var React=require("react"),cx=React.addons.classSet,Flx=require("ViewGallery/Flx"),SolutionInnerList=require("ViewGallery/SolutionInnerList"),SolutionItemFactory=require("ViewGallery/SolutionItemFactory"),SolutionGroup=React.createClass({displayName:"SolutionGroup",mixins:[Flx.Mixin],render:function(){var store=this.props.store,items=store.getListItems(),permissions=store.permissions,className=cx({"vg-list__group":!0,"vg-list__group-dragging":store.isDragging}),solutionStore=this.props.solutionStore;return React.createElement("div",{className:className},React.createElement("div",{className:"vg-list__groupheader"},permissions.collapse?React.createElement("h1",{className:"vg-list__collapsetrigger",onClick:this.handleCollapse},React.createElement("span",null,store.title)):React.createElement("h1",null,store.title),React.createElement("div",{className:"vg-list__grouptools"},permissions.add?React.createElement("i",{className:"vg-icon vg-icon-plus",onClick:this.handleStartAdd,title:"Add Solution"}):null,permissions.addFolder?React.createElement("i",{className:"vg-icon vg-icon-folder-plus",onClick:this.handleAddFolder,title:"Add Folder"}):null)),store.isCollapsed?null:React.createElement(SolutionInnerList,{factory:React.createFactory(SolutionItemFactory),solutionStore:solutionStore,store:solutionStore,groupStore:store,items:items}))
},handleStartAdd:function(){this.props.solutionStore.startAdd()},handleCollapse:function(){this.props.store.toggleCollapse()},handleAddFolder:function(){this.props.solutionStore.addFolder(null,{type:this.props.store.type})}});return module.exports=SolutionGroup,module.exports}),define("ViewGallery/SolutionInnerList",function(require,exports,module){var React=require("react"),SolutionInnerList=React.createClass({displayName:"SolutionInnerList",render:function(){var items=this.props.items,factory=this.props.factory,draggingIndex=this.props.groupStore.draggingIndex;return React.createElement("div",{className:"vg-list__innerlist"},items.map(function(v){return factory({item:v,factory:this.props.factory,store:this.props.store,groupStore:this.props.groupStore,key:v.objectId,index:v.userData.sourceIndex,draggingIndex:draggingIndex,sort:this.handleSort,sortStarted:this.handleSortStarted,sortCompleted:this.handleSortCompleted})}.bind(this)))},handleSort:function(from,to){this.props.groupStore.reorder(from,to)},handleSortStarted:function(index){this.props.groupStore.startSort(index)},handleSortCompleted:function(index){this.props.groupStore.prioritize(index)}});return module.exports=SolutionInnerList,module.exports}),define("ViewGallery/SolutionItem",function(require,exports,module){var React=require("react"),cx=React.addons.classSet,Confirmation=require("ViewGallery/Confirmation"),SortableMixin=require("ViewGallery/SortableMixin"),SolutionItem=React.createClass({displayName:"SolutionItem",mixins:[SortableMixin],render:function(){var inner,confirmation,item=this.props.item,permissions=this.props.store.permissions;if(item.userData.isWaitingConfirmation&&(confirmation=React.createElement(Confirmation,{orientation:"top",onConfirm:this.handleConfirmRemove,onCancel:this.handleCancelRemove},"Do you really want to remove this Solution?")),item.userData.isEditing)inner=React.createElement("form",{onSubmit:this.handleSubmit},React.createElement("input",{type:"text",ref:"input",defaultValue:item.title,placeholder:"Name",autoFocus:!0,maxLength:"50",onChange:this.handleChangeTitle,onBlur:this.handleCancel}));else{var hosts;if(permissions.edit){var str=item.hosts.join(", ");str&&(hosts=React.createElement("div",{className:"vg-list__itemhost"},str))}var innerClassName=cx({"vg-list__iteminner":!0,"vg-list__iteminner-hover":item.userData.isWaitingConfirmation,"vg-list__iteminner-selected":item.userData.isSelected});inner=React.createElement("div",{className:innerClassName},React.createElement("div",{className:"vg-list__itemname",onClick:this.handleSelect},React.createElement("div",{className:"vg-list__itemtitle",onDoubleClick:this.handleStartEdit},item.userData.isEditingFull?item.userData.tmpTitle||item.title:item.title),hosts),React.createElement("div",{className:"vg-list__itemtools"},permissions.remove?React.createElement("i",{className:"vg-icon vg-icon-bin",onClick:this.handleRemove,title:"Remove"}):null,confirmation))}var className=cx({"vg-list__item":!0,"vg-list__item-selected":item.userData.isSelected,"vg-list__item-hover":item.userData.isWaitingConfirmation,"vg-list__item-dragging":item.userData.isDragging,"vg-list__item-isnotmatching":!item.userData.isMatchFilter}),isDraggable=!this.props.item.userData.isEditing&&permissions.edit;return React.createElement("div",{className:className,draggable:isDraggable||null,"data-index":this.props.index,onDragStart:this.handleDragStart,onDragEnd:this.handleDragEnd,onDragOver:this.handleDragOver},inner)},handleSelect:function(){this.props.store.select(this.props.item)},handleStartEdit:function(){this.props.store.startEdit(this.props.item)},handleSubmit:function(e){e.preventDefault(),this.props.store.save(this.props.item,this.refs.input.getDOMNode().value)},handleCancel:function(){this.props.store.cancelEdit(this.props.item)},handleRemove:function(){this.props.store.startRemove(this.props.item)},handleConfirmRemove:function(){this.props.store.remove(this.props.item)},handleCancelRemove:function(){this.props.store.cancelRemove(this.props.item)},handleChangeTitle:function(e){var item=this.props.item;this.props.store.setTmpTitle(item,e.target.value)}});return module.exports=SolutionItem,module.exports}),define("ViewGallery/SolutionItemFactory",function(require,exports,module){var React=require("react"),SolutionItem=require("ViewGallery/SolutionItem"),SolutionFolder=require("ViewGallery/SolutionFolder"),SolutionItemFactory=React.createClass({displayName:"SolutionItemFactory",render:function(){var El={item:SolutionItem,folder:SolutionFolder}[this.props.item.type||"item"],factory=React.createFactory(SolutionItemFactory);return React.createElement(El,React.__spread({},this.props,{factory:factory}))}});return module.exports=SolutionItemFactory,module.exports}),define("ViewGallery/SolutionList",function(require,exports,module){var React=require("react"),Flx=require("ViewGallery/Flx"),SolutionGroup=require("ViewGallery/SolutionGroup"),Store=require("ViewGallery/solutionsGroupStore"),SearchInput=require("ViewGallery/SearchInput"),SolutionList=React.createClass({displayName:"SolutionList",mixins:[Flx.Mixin],render:function(){var store=this.props.store,items=store.getListItems();if(store.isLoading)return React.createElement("div",{className:"tau-loader"});var groups=items.map(function(v){return React.createElement(SolutionGroup,{key:v.host||"main",store:new Store(store,v),solutionStore:store})});return React.createElement("div",{className:"vg-list"},React.createElement("div",{className:"vg-list__search"},React.createElement("form",{onSubmit:this.handleSubmitFilter},React.createElement(SearchInput,{store:store}))),groups,React.createElement("div",{className:"vg-feedbacktrigger",onClick:this.handleStartFeedback},React.createElement("i",{className:"vg-icon vg-icon-bulb"}),React.createElement("div",null,React.createElement("strong",null,"Can't find the view you need?"),React.createElement("a",null,"Just let us know!"))))},handleSubmitFilter:function(e){e.preventDefault()},handleStartFeedback:function(){this.props.store.startFeedback()}});return module.exports=SolutionList,module.exports}),define("ViewGallery/SolutionViewer",function(require,exports,module){var React=require("react"),ReactCSSTransitionGroup=React.addons.CSSTransitionGroup,$=require("jQuery"),ViewList=require("ViewGallery/ViewList"),ViewsStore=require("ViewGallery/viewsStore"),FeedbackForm=require("ViewGallery/FeedbackForm"),SolutionViewerForm=require("ViewGallery/SolutionViewerForm"),SolutionViewerInner=require("ViewGallery/SolutionViewerInner"),SolutionViewerHeader=require("ViewGallery/SolutionViewerHeader"),StickyHeaderMixin=require("ViewGallery/StickyHeaderMixin"),ScrollToMixin=require("ViewGallery/ScrollToMixin"),SolutionViewer=React.createClass({displayName:"SolutionViewer",mixins:[StickyHeaderMixin,ScrollToMixin],getStickyHeaderParent:function(){return $(this.getDOMNode()).parents(".vg-right:first")[0]},componentDidMount:function(){this.changeListener=function(){this.isMounted()&&this.forceUpdate()}.bind(this),this.props.store.onChange(this.changeListener),window.addEventListener("resize",this.changeListener)},componentDidUpdate:function(){var scrollTo=this.props.store.scrollTo;"prereq"===scrollTo&&(this.scrollTo(),this.props.store.scrolledTo())},componentWillUnmount:function(){this.props.store.offChange(this.changeListener),window.removeEventListener("resize",this.changeListener)},render:function(){var item=this.props.store.getSelected();if(!item)return null;var inner,header;item.userData.isEditingFull?inner=React.createElement(SolutionViewerForm,{store:this.props.store,item:item}):(header=React.createElement(SolutionViewerHeader,{ref:"header",store:this.props.store,item:item}),inner=React.createElement(SolutionViewerInner,{ref:"inner",store:this.props.store,item:item}));var feedbackForm;this.props.store.isFeedback&&(feedbackForm=React.createElement(FeedbackForm,{store:this.props.store}));var viewsStore=new ViewsStore(item,this.props.store);return React.createElement("div",{className:"vg-viewer"},React.createElement(ReactCSSTransitionGroup,{transitionName:"vg-overlay-animation"},feedbackForm),header,inner,React.createElement(ViewList,{item:item,store:viewsStore}))}});return module.exports=SolutionViewer,module.exports}),define("ViewGallery/SolutionViewerForm",function(require,exports,module){var React=require("react"),_=require("Underscore"),boardApi=require("ViewGallery/boardApi"),MarkdownTextarea=require("ViewGallery/MarkdownTextarea"),ProcessSelect=require("ViewGallery/ProcessSelect"),Button=require("ViewGallery/Button"),SolutionViewerForm=React.createClass({displayName:"SolutionViewerForm",getInitialState:function(){return{viewFolders:[],isTitleChanged:!1}},componentDidMount:function(){this.props.item.objectId||boardApi.getViewFolders().then(function(items){this.setState({viewFolders:items})}.bind(this))},render:function(){var viewFoldersInput,item=this.props.item,disableProcessMessage=item.userData.viewsHasCfs?"You can set only process for solution or custom fields for views. Unset custom fields for all views to enable process":"";if(!item.objectId){var opts=this.state.viewFolders.map(function(v,k){return React.createElement("option",{key:k,value:k},v.title)}),select=React.createElement("select",{ref:"viewFolder",onChange:this.handleChangeTitleByFolder},React.createElement("option",{key:"zero",value:"-1"}),opts);viewFoldersInput=React.createElement("div",{className:"vg-forminput"},React.createElement("label",{htmlFor:"solution_processId"},"Copy folders from existing folder"),select)}var getItems=function(folderId,items,level){return _.reduce(items,function(res,v){return v&&(folderId&&v.folderId===folderId||!folderId&&!v.folderId)&&"folder"===v.type?(v.userData.level=level,res=res.concat(v),res=res.concat(getItems(v.objectId,items,v.userData.level+1))):res},[])},items=this.props.store.items.map(function(v){return v.userData.level=0,v});items=getItems(null,items,0);var folderInput=React.createElement("div",{className:"vg-forminput"},React.createElement("label",{htmlFor:"solution_processId"},"Folder"),React.createElement("select",{ref:"folderId",defaultValue:item.folderId},React.createElement("option",{key:"zero",value:""}),items.map(function(v){var pre=_.range(v.userData.level).map(function(){return String.fromCharCode(160)+String.fromCharCode(160)}).join("");return React.createElement("option",{key:v.objectId,value:v.objectId},pre,v.title)})));return React.createElement("div",{className:"vg-viewer__inner"},React.createElement("form",{onSubmit:this.handleSubmit},React.createElement("div",{className:"vg-forminput"},React.createElement("input",{type:"text",placeholder:"Title",ref:"title",autoFocus:!0,maxLength:"50",required:!0,pattern:".*\\S+.*",title:"Enter something",onChange:this.handleChangeTitle,defaultValue:item.title,value:item.userData.tmpTitle})),viewFoldersInput,React.createElement("div",{className:"vg-forminput"},React.createElement("input",{type:"text",placeholder:"xxxx.tpondemand.com",ref:"hosts",maxLength:"150",defaultValue:item.hosts?item.hosts.join(", "):item.host})),React.createElement("div",{className:"vg-forminput"},React.createElement(MarkdownTextarea,{placeholder:"Description",ref:"description",defaultValue:item.description})),React.createElement("div",{className:"vg-forminput"},React.createElement(MarkdownTextarea,{placeholder:"Prerequisites",ref:"prerequisites",defaultValue:item.prerequisites})),React.createElement("div",{className:"vg-forminput"},React.createElement("label",{htmlFor:"solution_processId"},"Process"),React.createElement(ProcessSelect,{id:"solution_processId",ref:"prerequisitesProcessId",disabled:item.userData.viewsHasCfs||null,title:disableProcessMessage,defaultValue:item.prerequisitesProcessId,process:item.prerequisitesData?item.prerequisitesData.process:null})),React.createElement("div",{className:"vg-forminput vg-forminput-video"},React.createElement("input",{type:"url",placeholder:"Youtube link",ref:"youtubeUrl",title:"Enter something",defaultValue:item.youtubeUrl})),folderInput,React.createElement("div",{className:"vg-buttons"},React.createElement(Button,{type:"submit",className:"vg-btn vg-btn-success vg-btn-big",loaderActive:item.userData.isLoading,loaderProgress:item.userData.loadProgress},"Save"),React.createElement("a",{className:"vg-cancellink",onClick:this.handleCancel},"Cancel"))))},handleChangeTitle:function(e){var item=this.props.item;this.props.store.setTmpTitle(item,e.target.value),this.state.isTitleChanged||this.setState({isTitleChanged:!0})},handleChangeTitleByFolder:function(e){if(!this.state.isTitleChanged){var item=this.props.item,text=e.target.selectedOptions[0]&&e.target.selectedOptions[0].text;this.props.store.setTmpTitle(item,text)}},handleCancel:function(){var item=this.props.store.getSelected();this.props.store.cancelEditFull(item)},handleSubmit:function(e){e.preventDefault();var data={};if(data.title=this.refs.title.getDOMNode().value.trim(),data.hosts=_.uniq(_.compact(this.refs.hosts.getDOMNode().value.split(",").map(function(v){return v.trim()}))),data.host=null,data.description=this.refs.description.getValue(),data.prerequisites=this.refs.prerequisites.getValue(),data.youtubeUrl=this.refs.youtubeUrl.getDOMNode().value.trim(),data.youtubeId=null,data.youtubeUrl){var match=data.youtubeUrl.match(/https?:\/\/www\.youtube.com\/watch\?v=([^&]+)/);match||(match=data.youtubeUrl.match(/https?:\/\/youtu.be\/([^&]+)/)),match&&(data.youtubeId=match[1])}var item=this.props.store.getSelected();data.prerequisitesProcessId=this.refs.prerequisitesProcessId.getDOMNode().value,data.folderId=this.refs.folderId.getDOMNode().value||null,this.refs.viewFolder&&(data.viewFolder=this.state.viewFolders[this.refs.viewFolder.getDOMNode().value]),this.props.store.saveFull(item,data)}});return module.exports=SolutionViewerForm,module.exports}),define("ViewGallery/SolutionViewerHeader",function(require,exports,module){var React=require("react"),ImportButton=require("ViewGallery/ImportButton"),Tooltip=require("ViewGallery/Tooltip"),SolutionViewerHeader=React.createClass({displayName:"SolutionViewerHeader",render:function(){var prereqTrigger,store=this.props.store,item=this.props.item,permissions=this.props.store.permissions;if(item.prerequisites||item.userData.fullPrerequisitesData){var tooltip;item.userData.showPrereqTooltip&&(tooltip=React.createElement(Tooltip,{orientation:"top"},"This solution has prerequisites, please read them before adding this solution.")),prereqTrigger=React.createElement("a",{className:"vg-prereqtrigger",onClick:this.handleTogglePrereq,onMouseEnter:this.handleShowPrereqTooltip,onMouseLeave:this.handleHidePrereqTooltip},item.userData.showPrereq?"Hide prerequisites":"Prerequisites",tooltip)}var editButtons;return permissions.edit&&(editButtons=React.createElement("button",{type:"button",className:"vg-btn vg-btn-ghost",onClick:this.handleStartEdit},"Edit")),React.createElement("div",{className:"vg-viewer__header vg-viewer__header-sticky"},React.createElement("h2",null,item.userData.isEditing?item.userData.tmpTitle||item.title:item.title),React.createElement("div",{className:"vg-viewer__tools"},prereqTrigger,editButtons,React.createElement(ImportButton,{item:item,store:store,type:"solution",onConfirm:this.handleImportConfirm,onCancel:this.handleImportCancel,onClick:this.handleCreateBoards},"Try the solution")))},handleTogglePrereq:function(){this.props.store.togglePrereq(this.props.item)},handleShowPrereqTooltip:function(){this.props.store.togglePrereqTooltip(this.props.item,!0)},handleHidePrereqTooltip:function(){this.props.store.togglePrereqTooltip(this.props.item,!1)},handleStartEdit:function(){this.props.store.startEditFull(this.props.item)},handleImportConfirm:function(confirmData){this.props.store.confirmImport(this.props.item,confirmData)},handleImportCancel:function(){this.props.store.cancelImport(this.props.item)},handleCreateBoards:function(){this.props.store.createBoards(this.props.item)}});return module.exports=SolutionViewerHeader,module.exports}),define("ViewGallery/SolutionViewerInner",function(require,exports,module){var React=require("react"),MarkdownOutput=require("ViewGallery/MarkdownOutput"),Prerequisites=require("ViewGallery/Prerequisites"),SolutionViewerInner=React.createClass({displayName:"SolutionViewerInner",render:function(){var prereq,item=this.props.item;item.userData.showPrereq&&(item.prerequisites||item.userData.fullPrerequisitesData)&&(prereq=React.createElement(Prerequisites,{item:item,store:this.props.store,type:"solution"}));var video,videoTrigger,videoLinks;return item.youtubeId&&(item.userData.showVideo?(videoLinks=React.createElement("div",{className:"vg-viewlist__itemvideolinks"},React.createElement("a",{href:"http://youtu.be/"+item.youtubeId,target:"_blank"},"http://youtu.be/"+item.youtubeId)),video=React.createElement("div",{className:"vg-viewlist__itemdescription vg-viewlist__itemvideo"},React.createElement("iframe",{src:"//www.youtube.com/embed/"+item.youtubeId+"?autoplay=1",frameBorder:"0",allowFullScreen:!0}))):videoTrigger=React.createElement("a",{className:"vg-viewlist__videotrigger",onClick:this.handleToggleVideo},React.createElement("i",{className:"vg-icon vg-icon-play"}),React.createElement("span",null,"Watch solution video"))),React.createElement("div",{className:"vg-viewer__inner"},prereq,React.createElement("div",{className:"vg-viewlist__itemdescription vg-viewlist__description"},React.createElement(MarkdownOutput,{html:item.descriptionHtml})),videoTrigger,videoLinks,video)},handleToggleVideo:function(){this.props.store.toggleVideo(this.props.item)}});return module.exports=SolutionViewerInner,module.exports}),define("ViewGallery/Tooltip",function(require,exports,module){var React=require("react"),cx=React.addons.classSet,Tooltip=React.createClass({displayName:"Tooltip",getDefaultProps:function(){return{orientation:"left"}},render:function(){var className={"tau-bubble tau-warning-bubble i-role-bubble i-state_visible vg-confirmation":!0};return className["i-orientation_"+this.props.orientation]=!0,this.props.className&&(className[this.props.className]=!0),className=cx(className),React.createElement("div",{className:className,"data-orientation":this.props.orientation},React.createElement("div",{className:"tau-bubble__arrow tau-container","data-orientation":this.props.orientation}),React.createElement("div",{className:"tau-bubble__inner tau-container"},this.props.children))}});return module.exports=Tooltip,module.exports}),define("ViewGallery/ViewConfig",function(require,exports,module){var React=require("react"),terms=require("ViewGallery/terms"),ViewConfig=React.createClass({displayName:"ViewConfig",render:function(){var item=this.props.item,config=item.config;if(!config)return null;var zoom;zoom="object"!=typeof item.config.zoomLevel?item.config.zoomLevel:item.config.zoomLevel[item.config.viewMode];var mainConfig=React.createElement("dl",null,React.createElement("div",{className:"vg-viewconfig__param"},React.createElement("dt",null,"Mode"),React.createElement("dd",null,terms.getViewModeTitle(item.config.viewMode))),React.createElement("div",{className:"vg-viewconfig__param"},React.createElement("dt",null,"Zoom"),React.createElement("dd",null,zoom))),res=React.createElement("div",{className:"vg-viewconfig"},this.renderConfigLine(config.cells,"Cards"),this.renderConfigLine(config.x,"Vertical lanes"),this.renderConfigLine(config.y,"Horizontal lanes"),React.createElement("div",null,mainConfig));return res},renderConfigLine:function(config,title){var res,filter,sort;if(config&&config.types&&config.types.length){filter=config.filter&&config.useFilter?React.createElement("div",{className:"vg-viewconfig__param"},React.createElement("dt",null,"Filter"),React.createElement("dd",null,config.filter)):React.createElement("div",{className:"vg-viewconfig__param"},React.createElement("span",null,"Filter is not set")),sort=config.ordering&&config.ordering.name?React.createElement("div",{className:"vg-viewconfig__param"},React.createElement("dt",null,"Sort"),React.createElement("dd",null,React.createElement("span",null,config.ordering.name)," ",React.createElement("span",null,config.ordering.direction))):React.createElement("div",{className:"vg-viewconfig__param"},React.createElement("span",null,"Sort is not set"));var types=config.types.map(function(v){return terms.getTermTitle(v)}).join(", ");res=React.createElement("dl",null,React.createElement("div",{className:"vg-viewconfig__param"},React.createElement("dt",null,title),React.createElement("dd",null,types)),filter,sort)}else res=React.createElement("dl",null,React.createElement("div",{className:"vg-viewconfig__param"},React.createElement("span",null,title+" are not set")));return React.createElement("div",null,res)}});return module.exports=ViewConfig,module.exports}),define("ViewGallery/ViewItem",function(require,exports,module){var React=require("react"),cx=React.addons.classSet,_=require("Underscore"),FileInput=require("ViewGallery/FileInput"),SortableMixin=require("ViewGallery/SortableMixin"),makeHttpsImg=require("ViewGallery/makeHttpsImg"),ViewItem=React.createClass({displayName:"ViewItem",mixins:[SortableMixin],render:function(){var img,item=this.props.item,className=cx({"vg-viewlist__item":!0,"vg-viewlist__item-active":item.userData.isSelected||item.userData.isEditing,"vg-viewlist__item-editing":item.userData.isEditing,"vg-viewlist__item-dragging":item.userData.isDragging,"vg-viewlist__item-notmatchfilter":!item.userData.isMatchFilter});img=item.previewImg?React.createElement("img",{className:"vg-viewlist__itemimg",key:item.id,src:makeHttpsImg(item.previewImg)}):React.createElement("div",{className:"vg-viewlist__itemimg"});var inner;inner=item.userData.isEditing?this.renderForm():React.createElement("div",{className:"vg-viewlist__iteminner"},React.createElement("h5",null,item.title),img,React.createElement("div",{className:"vg-viewlist__itemdescription"},item.shortDescription));var isDraggable=!item.userData.isEditing&&!this.props.store.solutionStore.isAdding&&this.props.store.permissions.edit;return React.createElement("div",{className:className,onClick:this.handleClick,"data-matched":item.userData.isMatchFilter||null,draggable:isDraggable||null,"data-index":this.props.index,onDragStart:this.handleDragStart,onDragEnd:this.handleDragEnd,onDragOver:this.handleDragOver},inner,React.createElement("div",{className:"vg-viewlist__itemhelper"}))},renderForm:function(){var item=this.props.item;return React.createElement("div",{className:"vg-viewlist__iteminner"},React.createElement("h5",null,item.userData.tmpTitle||item.title),React.createElement("div",{className:"vg-forminput vg-forminput-preview"},React.createElement(FileInput,{defaultValue:makeHttpsImg(item.previewImg),ref:"previewImg",fitImage:!0,width:184,height:114},"Load preview (184×114)")),React.createElement("div",{className:"vg-forminput"},React.createElement("textarea",{placeholder:"Short description",ref:"shortDescription",defaultValue:item.shortDescription})))},getFormData:function(){var data={};return _.forEach(this.refs,function(v,k){"previewImg"!==k&&"screenshotImg"!==k&&(data[k]=v.getDOMNode().value)}),data.previewImg=this.refs.previewImg.getValue(),data},handleClick:function(){this.props.store.select(this.props.item)}});return module.exports=ViewItem,module.exports}),define("ViewGallery/ViewItemFull",function(require,exports,module){var React=require("react"),ReactCSSTransitionGroup=React.addons.CSSTransitionGroup,$=require("jQuery"),MarkdownOutput=require("ViewGallery/MarkdownOutput"),ViewConfig=require("ViewGallery/ViewConfig"),ViewScreenshot=require("ViewGallery/ViewScreenshot"),Prerequisites=require("ViewGallery/Prerequisites"),ViewItemFullHeader=require("ViewGallery/ViewItemFullHeader"),Overlay=require("ViewGallery/Overlay"),StickyHeaderMixin=require("ViewGallery/StickyHeaderMixin"),ScrollToMixin=require("ViewGallery/ScrollToMixin"),ViewItemFull=React.createClass({displayName:"ViewItemFull",mixins:[StickyHeaderMixin,ScrollToMixin],getScrollToScrolledEl:function(){return $(this.getDOMNode()).find(".vg-overlay__content-scrollable:first")},componentDidUpdate:function(){var scrollTo=this.props.store.scrollTo;("prereq"===scrollTo||"top"===scrollTo)&&(this.scrollTo(),this.props.store.scrolledTo())},render:function(){var prereq,item=this.props.item,store=this.props.store,key="k"+(item.objectId||"00"),header=React.createElement(ViewItemFullHeader,{ref:"header",item:item,store:store});item.userData.showPrereq&&(item.prerequisites||item.userData.fullPrerequisitesData)&&(prereq=React.createElement(Prerequisites,{item:item,store:store,type:"view"}));var variations;item.userData.showVariations&&item.variations&&(variations=React.createElement("div",{className:"vg-viewer__variations vg-viewlist__itemdescription"},React.createElement(MarkdownOutput,{html:item.variationsHtml})));var variationsTrigger,img=React.createElement(ViewScreenshot,{item:item,store:store});item.variations&&(variationsTrigger=React.createElement("div",{className:"vg-variationstrigger"},React.createElement("a",{className:"vg-linktrigger",onClick:this.handleToggleVariations},item.userData.showVariations?"Hide variations":"Show variations")));var tags;item.tags.length&&(tags=item.tags.map(function(v,k){return React.createElement("a",{className:"vg-tag",key:"t"+k,onClick:this.handleSelectTag},v)}.bind(this)),tags=React.createElement("div",{className:"vg-viewlist__tags"},tags));var config,supportConfig=item.config&&!item.config.itemType||"board"===item.config.itemType;item.userData.showConfig&&supportConfig&&(config=React.createElement("div",{className:"vg-viewlist__itemdescription"},React.createElement(ViewConfig,{item:item})));var configTrigger;supportConfig&&(configTrigger=React.createElement("div",{className:"vg-viewlist__itemconfig"},React.createElement("a",{className:"vg-linktrigger",onClick:this.handleToggleConfig},item.userData.showConfig?"Hide the view configuration":"Show the view configuration")));var direction=store.pagingDirection;return React.createElement(Overlay,{onClose:this.handleCloseOverlay,className:"vg-overlay-itemfull"},header,React.createElement(ReactCSSTransitionGroup,{ref:"inner",component:"div",className:"vg-paging-animation-holder",transitionName:"vg-paging-animation-"+direction},React.createElement("div",{key:key,className:"vg-viewlist__itemfull vg-viewlist__itemfull-overlay vg-viewer"},prereq,React.createElement("div",{className:"vg-viewlist__itemdescription vg-viewlist__description"},React.createElement(MarkdownOutput,{html:item.descriptionHtml})),variationsTrigger,variations,img,tags,configTrigger,config)))},handleToggleVariations:function(){this.props.store.toggleVariations(this.props.item)},handleToggleConfig:function(){this.props.store.toggleConfig(this.props.item)},handleSelectTag:function(e){this.props.store.selectTag(e.target.innerText||e.target.textContent,this.props.item)},handleCloseOverlay:function(){this.props.store.select(this.props.item)},handleToggleScreenshot:function(){this.props.store.toggleScreenshot(this.props.item)}});return module.exports=ViewItemFull,module.exports}),define("ViewGallery/ViewItemFullForm",function(require,exports,module){var React=require("react"),FileInputMultiple=require("ViewGallery/FileInputMultiple"),_=require("Underscore"),Button=require("ViewGallery/Button"),MarkdownTextarea=require("ViewGallery/MarkdownTextarea"),ViewConfig=require("ViewGallery/ViewConfig"),FileInputMultipleStore=require("ViewGallery/fileInputMultipleStore"),CustomFieldsSelect=require("ViewGallery/CustomFieldsSelect"),boardApi=require("ViewGallery/boardApi"),ViewItemFull=React.createClass({displayName:"ViewItemFull",getInitialState:function(){return{parentId:null,isShowTooltip:!1,viewFolders:[],screenshotImgsStore:new FileInputMultipleStore(this.props.item)}},componentDidMount:function(){this.props.item.objectId&&boardApi.getGroupedViews().then(function(items){this.setState({viewFolders:items})}.bind(this))},render:function(){var config,item=this.props.item,supportConfig=item.config&&!item.config.itemType||"board"===item.config.itemType;item.userData.showConfig&&supportConfig&&(config=React.createElement("div",{className:"vg-viewlist__itemconfig"},React.createElement(ViewConfig,{item:item})));var viewFoldersInput;if(item.objectId){var opts=this.state.viewFolders.map(function(v,k){var sopts=v.boards.map(function(vv,kk){return React.createElement("option",{key:"o"+kk,value:vv.key},vv.title)});return React.createElement("optgroup",{key:"og"+k,label:v.title},sopts)}),select=React.createElement("select",{ref:"configByKey",onChange:this.handleChangeConfig},React.createElement("option",{key:"zero",value:""}),opts);viewFoldersInput=React.createElement("div",{className:"vg-forminput"},React.createElement("label",{htmlFor:"solution_processId"},"Use config from existing view"),select)}var parentOptions=this.props.store.getSolutions().map(function(v,k){var sopts=_.filter(v.items,function(v){return"folder"!==v.type}).map(function(vv,kk){return React.createElement("option",{key:"o"+kk,value:vv.objectId},vv.title)});return React.createElement("optgroup",{key:"og"+k,label:v.title},sopts)}),parentId=this.state.parentId||item.parentId||this.props.store.solution.objectId,solution=this.props.store.solution,disableCfs=solution.prerequisitesData&&solution.prerequisitesData.process,disableCfsMessage=disableCfs?"You can set only process for solution or custom fields for views. Unset process for parent solution to enable custom fields":"";return React.createElement("div",{className:"vg-viewlist__itemfull vg-viewer"},React.createElement("div",{className:"vg-forminput"},React.createElement("input",{type:"text",placeholder:"Title",ref:"title",autoFocus:!0,maxLength:"50",required:!0,pattern:".*\\S+.*",title:"Enter something",onChange:this.handleChangeTitle,defaultValue:item.title})),React.createElement("div",{className:"vg-forminput"},React.createElement("select",{ref:"parentId",value:parentId,onChange:this.handleChangeParentId},parentOptions)),viewFoldersInput,React.createElement("div",{className:"vg-forminput"},React.createElement(MarkdownTextarea,{placeholder:"Description",ref:"description",defaultValue:item.description})),React.createElement("div",{className:"vg-forminput"},React.createElement(MarkdownTextarea,{placeholder:"Prerequisites",ref:"prerequisites",defaultValue:item.prerequisites})),React.createElement("div",{className:"vg-forminput"},React.createElement(MarkdownTextarea,{placeholder:"Variations",ref:"variations",defaultValue:item.variations})),React.createElement("div",{className:"vg-forminput"},React.createElement("input",{type:"text",placeholder:"Tags",ref:"tags",defaultValue:item.tags.join(", ")})),React.createElement("div",{className:"vg-forminput vg-forminput-preview"},React.createElement(FileInputMultiple,{store:this.state.screenshotImgsStore,ref:"screenshotImg",width:892,height:542},"Load screenshot (892×524)")),React.createElement("div",{className:"vg-forminput-cfs"},React.createElement("label",{htmlFor:"cfs"},"Custom Fields"),React.createElement(CustomFieldsSelect,{ref:"prerequisitesDataCustomFields",id:"cfs",defaultValue:item.prerequisitesDataCustomFields||[],disabled:disableCfs||null,title:disableCfsMessage})),React.createElement("div",{className:"vg-forminput-checkbox"},React.createElement("label",null,React.createElement("input",{type:"checkbox",ref:"prerequisitesForceProcesses",defaultChecked:item.prerequisitesForceProcesses}),"Force to set custom fields for all processes")),supportConfig?React.createElement("div",{className:"vg-viewlist__itemconfig"},React.createElement("a",{className:"vg-linktrigger",onClick:this.handleToggleConfig},item.userData.showConfig?"Hide parameters of the view":"Show parameters of the view")):null,config,React.createElement("div",{className:"vg-buttons"},React.createElement(Button,{type:"submit",className:"vg-btn vg-btn-success vg-btn-big",loaderActive:item.userData.isLoading,loaderProgress:item.userData.loadProgress},"Save"),React.createElement("a",{className:"vg-cancellink",onClick:this.handleCancel},"Cancel")))
},handleCancel:function(){this.props.store.cancelEdit(this.props.item)},handleToggleConfig:function(){this.props.store.toggleConfig(this.props.item)},handleChangeTitle:function(e){this.props.store.setTmpTitle(this.props.item,e.target.value)},handleChangeParentId:function(e){this.props.item.objectId?this.setState({parentId:e.target.value}):this.props.store.selectSolution(e.target.value)},handleChangeConfig:function(e){e.target.value&&window.alert("Your existing config will be replaced after save!")},getFormData:function(){var data={};return _.forEach(this.refs,function(v,k){"previewImg"!==k&&"screenshotImg"!==k&&v.getDOMNode()&&(data[k]=v.getDOMNode().value)}),data.title=data.title.trim(),data.description=this.refs.description.getValue(),data.prerequisites=this.refs.prerequisites.getValue(),data.variations=this.refs.variations.getValue(),data.prerequisitesDataCustomFields=this.refs.prerequisitesDataCustomFields.getValue(),data.prerequisitesForceProcesses=Boolean(this.refs.prerequisitesForceProcesses.getDOMNode().checked),this.refs.configByKey&&(data.configByKey=this.refs.configByKey.getDOMNode().value),data.screenshotImg=this.refs.screenshotImg.getValue(),data}});return module.exports=ViewItemFull,module.exports}),define("ViewGallery/ViewItemFullHeader",function(require,exports,module){var React=require("react"),ImportButton=require("ViewGallery/ImportButton"),Confirmation=require("ViewGallery/Confirmation"),Tooltip=require("ViewGallery/Tooltip"),ViewItemFullHeader=React.createClass({displayName:"ViewItemFullHeader",getInitialState:function(){return{isShowTooltipPrevious:!1,isShowTooltipNext:!1}},render:function(){var editButtons,item=this.props.item,store=this.props.store,permissions=this.props.store.permissions;if(permissions.edit){var confirmation;item.userData.isWaitingConfirmation&&(confirmation=React.createElement(Confirmation,{onConfirm:this.handleConfirmRemove,onCancel:this.handleCancelRemove,orientation:"top"},"Do you really want to remove this "+item.userData.itemTypeTitle.slice(0,1).toUpperCase()+item.userData.itemTypeTitle.slice(1)+"?")),editButtons=React.createElement("div",{className:"vg-btn-group"},React.createElement("button",{type:"button",className:"vg-btn vg-btn-ghost",onClick:this.handleStartEdit},"Edit"),React.createElement("button",{type:"button",className:"vg-btn vg-btn-ghost vg-btn-remove",onClick:this.handleRemove},"Remove"),confirmation)}var prereqTrigger;if(item.prerequisites||item.userData.fullPrerequisitesData){var tooltip;item.userData.showPrereqTooltip&&(tooltip=React.createElement(Tooltip,{orientation:"top"},"This ",item.userData.itemTypeTitle," has prerequisites, please read them before adding this view.")),prereqTrigger=React.createElement("a",{className:"vg-prereqtrigger",onClick:this.handleTogglePrereq,onMouseEnter:this.handleShowPrereqTooltip,onMouseLeave:this.handleHidePrereqTooltip},item.userData.showPrereq?"Hide prerequisites":"Prerequisites",tooltip)}var hasPrev=store.hasPrev(item),viewPrev=React.createElement("button",{type:"button",className:"vg-btn",onClick:this.handleClickPrevious,disabled:hasPrev?null:!0,title:"Previous view"},"←"),hasNext=store.hasNext(item),viewNext=React.createElement("button",{type:"button",className:"vg-btn",onClick:this.handleClickNext,disabled:hasNext?null:!0,title:"Next view"},"→"),viewPager=React.createElement("div",{className:"vg-btn-group vg-viewpager"},viewPrev,viewNext);return React.createElement("div",{className:"vg-viewer__header vg-viewer__header-view vg-viewer__header-sticky"},React.createElement("h2",null,item.title),React.createElement("div",{className:"vg-viewer__tools"},prereqTrigger,editButtons,React.createElement(ImportButton,{item:item,store:store,type:"view",onConfirm:this.handleImportConfirm,onCancel:this.handleImportCancel,onClick:this.handleCreateBoard},"Try the ",item.userData.itemTypeTitle),viewPager))},handleStartEdit:function(){this.props.store.startEdit(this.props.item)},handleCreateBoard:function(){this.props.store.createBoard(this.props.item)},handleImportConfirm:function(confirmData){this.props.store.confirmImport(this.props.item,confirmData)},handleImportCancel:function(){this.props.store.cancelImport(this.props.item)},handleShowPrereqTooltip:function(){this.props.store.togglePrereqTooltip(this.props.item,!0)},handleHidePrereqTooltip:function(){this.props.store.togglePrereqTooltip(this.props.item,!1)},handleRemove:function(){this.props.store.startRemove(this.props.item)},handleConfirmRemove:function(){this.props.store.remove(this.props.item)},handleCancelRemove:function(){this.props.store.cancelRemove(this.props.item)},handleTogglePrereq:function(){this.props.store.togglePrereq(this.props.item)},handleClickNext:function(){this.props.store.selectNext(this.props.item)},handleClickPrevious:function(){this.props.store.selectPrevious(this.props.item)}});return module.exports=ViewItemFullHeader,module.exports}),define("ViewGallery/ViewList",function(require,exports,module){var $=require("jQuery"),_=require("Underscore"),React=require("react"),cx=React.addons.classSet,ReactCSSTransitionGroup=React.addons.CSSTransitionGroup,Flx=require("ViewGallery/Flx"),ViewItem=require("ViewGallery/ViewItem"),ViewItemFull=require("ViewGallery/ViewItemFull"),ViewItemFullForm=require("ViewGallery/ViewItemFullForm"),ScrollToMixin=require("ViewGallery/ScrollToMixin"),ViewList=React.createClass({displayName:"ViewList",mixins:[Flx.Mixin,ScrollToMixin],componentDidMount:function(){this.props.store.read()},componentDidUpdate:function(){var scrollTo=this.props.store.scrollTo;if(scrollTo){if("start"===scrollTo)this.scrollTo();else{var selector={search:"[data-matched]",edit:".vg-viewlist__item-editing",select:".vg-viewlist__item-active"}[scrollTo];if(selector){var $scrollTo=$(this.getDOMNode()).find(selector).first();$scrollTo.length&&this.scrollTo($scrollTo[0],"edit"===scrollTo?-10:-50)}}this.props.store.scrolledTo()}},render:function(){var store=this.props.store,items=store.getListItems(),selected=store.getSelected(),groupLen=1;document.body.clientWidth>=1200?groupLen=4:document.body.clientWidth>=992?groupLen=3:document.body.clientWidth>=768&&(groupLen=2);var viewer,grouped=_.range(0,Math.ceil(items.length/groupLen)).map(function(v){return items.slice(v*groupLen,(v+1)*groupLen)}),className=cx({"vg-viewlist":!0,"vg-viewlist-dragging":store.isDragging});return selected&&!selected.userData.isEditing&&selected.objectId&&(viewer=React.createElement(ViewItemFull,{ref:"viewer",key:"viewer",item:selected,store:this.props.store})),React.createElement("div",{className:className},grouped.map(function(subitems,k){return this.renderRow(subitems,selected,k,groupLen*k,groupLen)}.bind(this)),React.createElement(ReactCSSTransitionGroup,{transitionName:"vg-overlay-animation"},viewer))},renderRow:function(items,selected,num,itemIndex,groupLen){var editor,store=this.props.store,hasSelected=items.indexOf(selected)>=0;hasSelected&&selected&&selected.userData.isEditing&&(editor=React.createElement(ViewItemFullForm,{key:"e"+selected.objectId||"00",ref:"viewer",item:selected,store:this.props.store}));var dummies,draggingIndex=store.draggingIndex;items.length<groupLen&&(dummies=_.keys(_.range(items.length,groupLen)).map(function(k){return React.createElement("div",{key:"dummy"+k,className:"vg-viewlist__itemdummy"})}));var permissions=store.permissions,hasEditable=hasSelected&&selected.userData.isEditing;return React.createElement("div",{className:"vg-viewlist__row",key:hasEditable?"editable_is_here":"r"+num,onDrop:this.handleDrop},React.createElement("form",{onSubmit:this.handleSubmit},React.createElement("div",{className:"vg-viewlist__rowinner"},items.map(function(v,k){return React.createElement(ViewItem,{ref:v.userData.isEditing?"item":null,key:v.objectId||"k0",item:v,store:store,index:itemIndex+k,draggingIndex:draggingIndex,sort:permissions.edit&&this.handleSort,sortStarted:permissions.edit&&this.handleSortStarted,sortCompleted:permissions.edit&&this.handleSortCompleted})}.bind(this)),dummies),editor))},handleSubmit:function(e){e.preventDefault();var itemData=this.refs.item.getFormData(),viewerData=this.refs.viewer.getFormData(),data=_.extend(itemData,viewerData),edited=_.find(this.props.store.items,function(v){return v.userData.isEditing});this.props.store.save(edited,data)},handleSort:function(from,to){this.props.store.reorder(from,to),this.to=to},handleSortStarted:function(index){this.props.store.startSort(index)},handleSortCompleted:function(to){this.to=null,this.props.store.prioritize(to)},handleDrop:function(e){e.preventDefault(),null!==this.to&&this.props.store.prioritize(this.to)}});return module.exports=ViewList,module.exports}),define("ViewGallery/ViewScreenshot",function(require,exports,module){var $=require("jQuery"),React=require("react"),ReactCSSTransitionGroup=React.addons.CSSTransitionGroup,cx=React.addons.classSet,_=require("Underscore"),makeHttpsImg=require("ViewGallery/makeHttpsImg"),Overlay=require("ViewGallery/Overlay"),ViewScreenshot=React.createClass({displayName:"ViewScreenshot",getInitialState:function(){var item=this.props.item,urls=item.screenshotImgs&&item.screenshotImgs.length?item.screenshotImgs:null;return urls=urls||(item.screenshotImg?[item.screenshotImg]:[]),{activeIndex:0,hasNext:urls.length>1,showOverlay:!1,urls:urls}},componentDidUpdate:function(){if(this.refs.inner){var $inner=$(this.refs.inner.getDOMNode());$inner.animate({scrollLeft:this.state.activeIndex*$inner[0].getBoundingClientRect().width})}},render:function(){var item=this.props.item,key="k"+item.objectId,urls=this.state.urls;if(!urls.length)return null;var imgs;imgs=urls.map(function(v,k){return React.createElement("div",{className:"vg-carousel__item",key:key+k},React.createElement("img",{className:"vg-carousel__img",onClick:this.handleToggleScreenshot,src:makeHttpsImg(v)}))}.bind(this));var indicators;if(urls.length>1){var indicatorItems=_.keys(urls).map(function(k){var className=cx({"vg-carousel__indicator":!0,"vg-carousel__indicator-active":k===this.state.activeIndex});return React.createElement("div",{className:className,"data-index":k,onClick:this.handleSelectActive,key:key+k})}.bind(this));indicators=React.createElement("div",{className:"vg-carousel__indicators"},indicatorItems)}var arrows;if(urls.length>1){var nextArrow;this.state.hasNext&&(nextArrow=React.createElement("a",{className:"vg-carousel__arrow vg-carousel__arrow-right",onClick:this.handleClickArrowRight},React.createElement("i",{className:"vg-icon vg-icon-arrow-next-white"})));var prevArrow;this.state.hasPrev&&(prevArrow=React.createElement("a",{className:"vg-carousel__arrow vg-carousel__arrow-left",onClick:this.handleClickArrowLeft},React.createElement("i",{className:"vg-icon vg-icon-arrow-prev-white"}))),arrows=React.createElement("div",{className:"vg-carousel__arrows"},prevArrow,nextArrow)}var viewer;if(this.state.showOverlay){var url=urls[this.state.activeIndex];viewer=React.createElement(Overlay,{onClose:this.handleToggleScreenshot,stretch:!1},React.createElement("div",{className:"vg-carousel__wrap"},React.createElement("img",{className:"vg-viewlist__itemimgsimple",onClick:this.handleToggleScreenshot,src:makeHttpsImg(url)}),arrows))}return React.createElement("div",{className:"vg-carousel vg-viewlist__itemimg"},indicators,React.createElement("div",{className:"vg-carousel__wrap"},React.createElement("div",{className:"vg-carousel__inner",ref:"inner"},imgs),arrows),React.createElement(ReactCSSTransitionGroup,{key:"ov"+key,className:"vg-carousel__viewer",transitionName:"vg-overlay-animation"},viewer))},handleSelectActive:function(e){var ind=Number(e.target.dataset.index);this.setState({activeIndex:ind,hasPrev:ind>0,hasNext:ind<this.state.urls.length-1})},handleToggleScreenshot:function(){this.setState({showOverlay:!this.state.showOverlay})},handleClickArrowLeft:function(){var ind=this.state.activeIndex-1;this.setState({activeIndex:ind,hasPrev:ind>0,hasNext:ind<this.state.urls.length-1})},handleClickArrowRight:function(){var ind=this.state.activeIndex+1;this.setState({activeIndex:ind,hasPrev:ind>0,hasNext:ind<this.state.urls.length-1})}});return module.exports=ViewScreenshot,module.exports});var Showdown={extensions:{}},forEach=Showdown.forEach=function(obj,callback){if("function"==typeof obj.forEach)obj.forEach(callback);else{var i,len=obj.length;for(i=0;len>i;i++)callback(obj[i],i,obj)}},stdExtName=function(s){return s.replace(/[_-]||\s/g,"").toLowerCase()};Showdown.converter=function(converter_options){var g_urls,g_titles,g_html_blocks,g_list_level=0,g_lang_extensions=[],g_output_modifiers=[];if("undefind"!=typeof module&&"undefined"!=typeof exports&&"undefind"!=typeof require){var fs=require("fs");if(fs){var extensions=fs.readdirSync((__dirname||".")+"/extensions").filter(function(file){return~file.indexOf(".js")}).map(function(file){return file.replace(/\.js$/,"")});Showdown.forEach(extensions,function(ext){var name=stdExtName(ext);Showdown.extensions[name]=require("./extensions/"+ext)})}}if(this.makeHtml=function(text){return g_urls={},g_titles={},g_html_blocks=[],text=text.replace(/~/g,"~T"),text=text.replace(/\$/g,"~D"),text=text.replace(/\r\n/g,"\n"),text=text.replace(/\r/g,"\n"),text="\n\n"+text+"\n\n",text=_Detab(text),text=text.replace(/^[ \t]+$/gm,""),Showdown.forEach(g_lang_extensions,function(x){text=_ExecuteExtension(x,text)}),text=_DoGithubCodeBlocks(text),text=_HashHTMLBlocks(text),text=_StripLinkDefinitions(text),text=_RunBlockGamut(text),text=_UnescapeSpecialChars(text),text=text.replace(/~D/g,"$$"),text=text.replace(/~T/g,"~"),Showdown.forEach(g_output_modifiers,function(x){text=_ExecuteExtension(x,text)}),text},converter_options&&converter_options.extensions){var self=this;Showdown.forEach(converter_options.extensions,function(plugin){if("string"==typeof plugin&&(plugin=Showdown.extensions[stdExtName(plugin)]),"function"!=typeof plugin)throw"Extension '"+plugin+"' could not be loaded.  It was either not found or is not a valid extension.";Showdown.forEach(plugin(self),function(ext){ext.type?"language"===ext.type||"lang"===ext.type?g_lang_extensions.push(ext):("output"===ext.type||"html"===ext.type)&&g_output_modifiers.push(ext):g_output_modifiers.push(ext)})})}var _ProcessListItems,_ExecuteExtension=function(ext,text){if(ext.regex){var re=new RegExp(ext.regex,"g");return text.replace(re,ext.replace)}return ext.filter?ext.filter(text):void 0},_StripLinkDefinitions=function(text){return text+="~0",text=text.replace(/^[ ]{0,3}\[(.+)\]:[ \t]*\n?[ \t]*<?(\S+?)>?[ \t]*\n?[ \t]*(?:(\n*)["(](.+?)[")][ \t]*)?(?:\n+|(?=~0))/gm,function(wholeMatch,m1,m2,m3,m4){return m1=m1.toLowerCase(),g_urls[m1]=_EncodeAmpsAndAngles(m2),m3?m3+m4:(m4&&(g_titles[m1]=m4.replace(/"/g,"&quot;")),"")}),text=text.replace(/~0/,"")},_HashHTMLBlocks=function(text){text=text.replace(/\n/g,"\n\n");return text=text.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math|ins|del)\b[^\r]*?\n<\/\2>[ \t]*(?=\n+))/gm,hashElement),text=text.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math|style|section|header|footer|nav|article|aside)\b[^\r]*?<\/\2>[ \t]*(?=\n+)\n)/gm,hashElement),text=text.replace(/(\n[ ]{0,3}(<(hr)\b([^<>])*?\/?>)[ \t]*(?=\n{2,}))/g,hashElement),text=text.replace(/(\n\n[ ]{0,3}<!(--[^\r]*?--\s*)+>[ \t]*(?=\n{2,}))/g,hashElement),text=text.replace(/(?:\n\n)([ ]{0,3}(?:<([?%])[^\r]*?\2>)[ \t]*(?=\n{2,}))/g,hashElement),text=text.replace(/\n\n/g,"\n")},hashElement=function(wholeMatch,m1){var blockText=m1;return blockText=blockText.replace(/\n\n/g,"\n"),blockText=blockText.replace(/^\n/,""),blockText=blockText.replace(/\n+$/g,""),blockText="\n\n~K"+(g_html_blocks.push(blockText)-1)+"K\n\n"},_RunBlockGamut=function(text){text=_DoHeaders(text);var key=hashBlock("<hr />");return text=text.replace(/^[ ]{0,2}([ ]?\*[ ]?){3,}[ \t]*$/gm,key),text=text.replace(/^[ ]{0,2}([ ]?\-[ ]?){3,}[ \t]*$/gm,key),text=text.replace(/^[ ]{0,2}([ ]?\_[ ]?){3,}[ \t]*$/gm,key),text=_DoLists(text),text=_DoCodeBlocks(text),text=_DoBlockQuotes(text),text=_HashHTMLBlocks(text),text=_FormParagraphs(text)},_RunSpanGamut=function(text){return text=_DoCodeSpans(text),text=_EscapeSpecialCharsWithinTagAttributes(text),text=_EncodeBackslashEscapes(text),text=_DoImages(text),text=_DoAnchors(text),text=_DoAutoLinks(text),text=_EncodeAmpsAndAngles(text),text=_DoItalicsAndBold(text),text=text.replace(/  +\n/g," <br />\n")},_EscapeSpecialCharsWithinTagAttributes=function(text){var regex=/(<[a-z\/!$]("[^"]*"|'[^']*'|[^'">])*>|<!(--.*?--\s*)+>)/gi;return text=text.replace(regex,function(wholeMatch){var tag=wholeMatch.replace(/(.)<\/?code>(?=.)/g,"$1`");return tag=escapeCharacters(tag,"\\`*_")})},_DoAnchors=function(text){return text=text.replace(/(\[((?:\[[^\]]*\]|[^\[\]])*)\][ ]?(?:\n[ ]*)?\[(.*?)\])()()()()/g,writeAnchorTag),text=text.replace(/(\[((?:\[[^\]]*\]|[^\[\]])*)\]\([ \t]*()<?(.*?(?:\(.*?\).*?)?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g,writeAnchorTag),text=text.replace(/(\[([^\[\]]+)\])()()()()()/g,writeAnchorTag)},writeAnchorTag=function(wholeMatch,m1,m2,m3,m4,m5,m6,m7){void 0==m7&&(m7="");var whole_match=m1,link_text=m2,link_id=m3.toLowerCase(),url=m4,title=m7;if(""==url)if(""==link_id&&(link_id=link_text.toLowerCase().replace(/ ?\n/g," ")),url="#"+link_id,void 0!=g_urls[link_id])url=g_urls[link_id],void 0!=g_titles[link_id]&&(title=g_titles[link_id]);else{if(!(whole_match.search(/\(\s*\)$/m)>-1))return whole_match;url=""}url=escapeCharacters(url,"*_");var result='<a href="'+url+'"';return""!=title&&(title=title.replace(/"/g,"&quot;"),title=escapeCharacters(title,"*_"),result+=' title="'+title+'"'),result+=">"+link_text+"</a>"},_DoImages=function(text){return text=text.replace(/(!\[(.*?)\][ ]?(?:\n[ ]*)?\[(.*?)\])()()()()/g,writeImageTag),text=text.replace(/(!\[(.*?)\]\s?\([ \t]*()<?(\S+?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g,writeImageTag)},writeImageTag=function(wholeMatch,m1,m2,m3,m4,m5,m6,m7){var whole_match=m1,alt_text=m2,link_id=m3.toLowerCase(),url=m4,title=m7;if(title||(title=""),""==url){if(""==link_id&&(link_id=alt_text.toLowerCase().replace(/ ?\n/g," ")),url="#"+link_id,void 0==g_urls[link_id])return whole_match;url=g_urls[link_id],void 0!=g_titles[link_id]&&(title=g_titles[link_id])}alt_text=alt_text.replace(/"/g,"&quot;"),url=escapeCharacters(url,"*_");var result='<img src="'+url+'" alt="'+alt_text+'"';return title=title.replace(/"/g,"&quot;"),title=escapeCharacters(title,"*_"),result+=' title="'+title+'"',result+=" />"},_DoHeaders=function(text){function headerId(m){return m.replace(/[^\w]/g,"").toLowerCase()}return text=text.replace(/^(.+)[ \t]*\n=+[ \t]*\n+/gm,function(wholeMatch,m1){return hashBlock('<h1 id="'+headerId(m1)+'">'+_RunSpanGamut(m1)+"</h1>")}),text=text.replace(/^(.+)[ \t]*\n-+[ \t]*\n+/gm,function(matchFound,m1){return hashBlock('<h2 id="'+headerId(m1)+'">'+_RunSpanGamut(m1)+"</h2>")}),text=text.replace(/^(\#{1,6})[ \t]*(.+?)[ \t]*\#*\n+/gm,function(wholeMatch,m1,m2){var h_level=m1.length;return hashBlock("<h"+h_level+' id="'+headerId(m2)+'">'+_RunSpanGamut(m2)+"</h"+h_level+">")})},_DoLists=function(text){text+="~0";var whole_list=/^(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/gm;return g_list_level?text=text.replace(whole_list,function(wholeMatch,m1,m2){var list=m1,list_type=m2.search(/[*+-]/g)>-1?"ul":"ol";list=list.replace(/\n{2,}/g,"\n\n\n");var result=_ProcessListItems(list);return result=result.replace(/\s+$/,""),result="<"+list_type+">"+result+"</"+list_type+">\n"}):(whole_list=/(\n\n|^\n?)(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/g,text=text.replace(whole_list,function(wholeMatch,m1,m2,m3){var runup=m1,list=m2,list_type=m3.search(/[*+-]/g)>-1?"ul":"ol",list=list.replace(/\n{2,}/g,"\n\n\n"),result=_ProcessListItems(list);return result=runup+"<"+list_type+">\n"+result+"</"+list_type+">\n"})),text=text.replace(/~0/,"")};_ProcessListItems=function(list_str){return g_list_level++,list_str=list_str.replace(/\n{2,}$/,"\n"),list_str+="~0",list_str=list_str.replace(/(\n)?(^[ \t]*)([*+-]|\d+[.])[ \t]+([^\r]+?(\n{1,2}))(?=\n*(~0|\2([*+-]|\d+[.])[ \t]+))/gm,function(wholeMatch,m1,m2,m3,m4){var item=m4,leading_line=m1;return leading_line||item.search(/\n{2,}/)>-1?item=_RunBlockGamut(_Outdent(item)):(item=_DoLists(_Outdent(item)),item=item.replace(/\n$/,""),item=_RunSpanGamut(item)),"<li>"+item+"</li>\n"}),list_str=list_str.replace(/~0/g,""),g_list_level--,list_str};var _DoCodeBlocks=function(text){return text+="~0",text=text.replace(/(?:\n\n|^)((?:(?:[ ]{4}|\t).*\n+)+)(\n*[ ]{0,3}[^ \t\n]|(?=~0))/g,function(wholeMatch,m1,m2){var codeblock=m1,nextChar=m2;return codeblock=_EncodeCode(_Outdent(codeblock)),codeblock=_Detab(codeblock),codeblock=codeblock.replace(/^\n+/g,""),codeblock=codeblock.replace(/\n+$/g,""),codeblock="<pre><code>"+codeblock+"\n</code></pre>",hashBlock(codeblock)+nextChar}),text=text.replace(/~0/,"")},_DoGithubCodeBlocks=function(text){return text+="~0",text=text.replace(/(?:^|\n)```(.*)\n([\s\S]*?)\n```/g,function(wholeMatch,m1,m2){var language=m1,codeblock=m2;return codeblock=_EncodeCode(codeblock),codeblock=_Detab(codeblock),codeblock=codeblock.replace(/^\n+/g,""),codeblock=codeblock.replace(/\n+$/g,""),codeblock="<pre><code"+(language?' class="'+language+'"':"")+">"+codeblock+"\n</code></pre>",hashBlock(codeblock)}),text=text.replace(/~0/,"")},hashBlock=function(text){return text=text.replace(/(^\n+|\n+$)/g,""),"\n\n~K"+(g_html_blocks.push(text)-1)+"K\n\n"},_DoCodeSpans=function(text){return text=text.replace(/(^|[^\\])(`+)([^\r]*?[^`])\2(?!`)/gm,function(wholeMatch,m1,m2,m3){var c=m3;return c=c.replace(/^([ \t]*)/g,""),c=c.replace(/[ \t]*$/g,""),c=_EncodeCode(c),m1+"<code>"+c+"</code>"})},_EncodeCode=function(text){return text=text.replace(/&/g,"&amp;"),text=text.replace(/</g,"&lt;"),text=text.replace(/>/g,"&gt;"),text=escapeCharacters(text,"*_{}[]\\",!1)},_DoItalicsAndBold=function(text){return text=text.replace(/(\*\*|__)(?=\S)([^\r]*?\S[*_]*)\1/g,"<strong>$2</strong>"),text=text.replace(/(\*|_)(?=\S)([^\r]*?\S)\1/g,"<em>$2</em>")},_DoBlockQuotes=function(text){return text=text.replace(/((^[ \t]*>[ \t]?.+\n(.+\n)*\n*)+)/gm,function(wholeMatch,m1){var bq=m1;return bq=bq.replace(/^[ \t]*>[ \t]?/gm,"~0"),bq=bq.replace(/~0/g,""),bq=bq.replace(/^[ \t]+$/gm,""),bq=_RunBlockGamut(bq),bq=bq.replace(/(^|\n)/g,"$1  "),bq=bq.replace(/(\s*<pre>[^\r]+?<\/pre>)/gm,function(wholeMatch,m1){var pre=m1;return pre=pre.replace(/^  /gm,"~0"),pre=pre.replace(/~0/g,"")}),hashBlock("<blockquote>\n"+bq+"\n</blockquote>")})},_FormParagraphs=function(text){text=text.replace(/^\n+/g,""),text=text.replace(/\n+$/g,"");for(var grafs=text.split(/\n{2,}/g),grafsOut=[],end=grafs.length,i=0;end>i;i++){var str=grafs[i];str.search(/~K(\d+)K/g)>=0?grafsOut.push(str):str.search(/\S/)>=0&&(str=_RunSpanGamut(str),str=str.replace(/^([ \t]*)/g,"<p>"),str+="</p>",grafsOut.push(str))}end=grafsOut.length;for(var i=0;end>i;i++)for(;grafsOut[i].search(/~K(\d+)K/)>=0;){var blockText=g_html_blocks[RegExp.$1];blockText=blockText.replace(/\$/g,"$$$$"),grafsOut[i]=grafsOut[i].replace(/~K\d+K/,blockText)}return grafsOut.join("\n\n")},_EncodeAmpsAndAngles=function(text){return text=text.replace(/&(?!#?[xX]?(?:[0-9a-fA-F]+|\w+);)/g,"&amp;"),text=text.replace(/<(?![a-z\/?\$!])/gi,"&lt;")},_EncodeBackslashEscapes=function(text){return text=text.replace(/\\(\\)/g,escapeCharacters_callback),text=text.replace(/\\([`*_{}\[\]()>#+-.!])/g,escapeCharacters_callback)},_DoAutoLinks=function(text){return text=text.replace(/<((https?|ftp|dict):[^'">\s]+)>/gi,'<a href="$1">$1</a>'),text=text.replace(/<(?:mailto:)?([-.\w]+\@[-a-z0-9]+(\.[-a-z0-9]+)*\.[a-z]+)>/gi,function(wholeMatch,m1){return _EncodeEmailAddress(_UnescapeSpecialChars(m1))})},_EncodeEmailAddress=function(addr){var encode=[function(ch){return"&#"+ch.charCodeAt(0)+";"},function(ch){return"&#x"+ch.charCodeAt(0).toString(16)+";"},function(ch){return ch}];return addr="mailto:"+addr,addr=addr.replace(/./g,function(ch){if("@"==ch)ch=encode[Math.floor(2*Math.random())](ch);else if(":"!=ch){var r=Math.random();ch=r>.9?encode[2](ch):r>.45?encode[1](ch):encode[0](ch)}return ch}),addr='<a href="'+addr+'">'+addr+"</a>",addr=addr.replace(/">.+:/g,'">')},_UnescapeSpecialChars=function(text){return text=text.replace(/~E(\d+)E/g,function(wholeMatch,m1){var charCodeToReplace=parseInt(m1);return String.fromCharCode(charCodeToReplace)})},_Outdent=function(text){return text=text.replace(/^(\t|[ ]{1,4})/gm,"~0"),text=text.replace(/~0/g,"")},_Detab=function(text){return text=text.replace(/\t(?=\t)/g,"    "),text=text.replace(/\t/g,"~A~B"),text=text.replace(/~B(.+?)~A/g,function(wholeMatch,m1){for(var leadingText=m1,numSpaces=4-leadingText.length%4,i=0;numSpaces>i;i++)leadingText+=" ";return leadingText}),text=text.replace(/~A/g,"    "),text=text.replace(/~B/g,"")},escapeCharacters=function(text,charsToEscape,afterBackslash){var regexString="(["+charsToEscape.replace(/([\[\]\\])/g,"\\$1")+"])";afterBackslash&&(regexString="\\\\"+regexString);var regex=new RegExp(regexString,"g");return text=text.replace(regex,escapeCharacters_callback)},escapeCharacters_callback=function(wholeMatch,m1){var charCodeToEscape=m1.charCodeAt(0);return"~E"+charCodeToEscape+"E"}},"undefined"!=typeof module&&(module.exports=Showdown),"function"==typeof define&&define.amd&&define("showdown",function(){return Showdown});